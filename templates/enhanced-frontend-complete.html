<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>办公文档智能代理 - 完整版</title>
    <link rel="stylesheet" href="/static/css/enhanced-frontend-complete.css">
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
    <meta name="description" content="智能办公文档处理系统，支持格式对齐、文风统一、智能填报、文档审查等功能">

    <!-- 智能填报专用样式 -->
    <style>
        .status-display {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            background-color: #f8f9fa;
        }

        .status-success {
            color: #155724;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 8px;
        }

        .status-error {
            color: #721c24;
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            padding: 15px;
            border-radius: 8px;
        }

        .loading-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background-color: #e3f2fd;
            border-radius: 8px;
            margin: 15px 0;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #2196F3;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .feedback-message.success {
            color: #155724;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .feedback-message.error {
            color: #721c24;
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .input-textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-family: inherit;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
        }

        .input-select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-family: inherit;
            font-size: 14px;
            background-color: white;
        }

        .btn {
            display: inline-block;
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background-color: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background-color: #0056b3;
        }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #545b62;
        }

        .btn-success {
            background-color: #28a745;
            color: white;
        }

        .btn-success:hover {
            background-color: #1e7e34;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .workflow-block {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .workflow-title {
            color: #2c3e50;
            margin-bottom: 16px;
            font-size: 18px;
            font-weight: 600;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <!-- 全局进度条 -->
    <div class="global-progress-bar" id="global-progress" role="progressbar" aria-label="全局进度">
        <div class="progress-fill" id="progress-fill"></div>
    </div>

    <div class="app-container">
        <!-- 应用头部 -->
        <header class="app-header">
            <h1 class="main-title">📄 办公文档智能代理</h1>
            <div class="logo">📄 办公文档智能代理</div>
            <nav class="main-nav" role="navigation" aria-label="主导航">
                <a href="#" class="nav-item active" data-scene="format" aria-label="格式对齐功能">格式对齐</a>
                <a href="#" class="nav-item" data-scene="style" aria-label="文风统一功能">文风统一</a>
                <a href="#" class="nav-item" data-scene="fill" aria-label="智能填报功能">智能填报</a>
                <a href="#" class="nav-item" data-scene="review" aria-label="文档审查功能">文档审查</a>
            </nav>
        </header>

        <!-- 格式对齐场景 - 重新设计 -->
        <section id="scene-format" class="scene-section">
            <h2 class="scene-title">📐 AI格式对齐</h2>
            <p class="scene-description">基于星火X1大模型的智能格式对齐系统，支持预设格式模板和自定义格式学习</p>

            <!-- 5步工作流程指示器 -->
            <div class="step-indicator" role="progressbar" aria-label="格式对齐进度">
                <div class="step-item active">
                    <div class="step-number">1</div>
                    <span>选择模式</span>
                </div>
                <div class="step-line"></div>
                <div class="step-item">
                    <div class="step-number">2</div>
                    <span>配置格式</span>
                </div>
                <div class="step-line"></div>
                <div class="step-item">
                    <div class="step-number">3</div>
                    <span>上传文档</span>
                </div>
                <div class="step-line"></div>
                <div class="step-item">
                    <div class="step-number">4</div>
                    <span>导出结果</span>
                </div>
            </div>

            <!-- 步骤1: 处理模式选择 -->
            <div class="workflow-block" id="format-mode-selection">
                <h3 class="workflow-title">📋 选择处理模式</h3>

                <div class="mode-selector">
                    <div class="mode-option" data-mode="preset">
                        <div class="mode-icon">🎯</div>
                        <div class="mode-info">
                            <h4>预设格式模板</h4>
                            <p>使用内置的专业格式模板（公文、报告、论文等）</p>
                        </div>
                        <input type="radio" name="format-mode" value="preset" id="format-mode-preset" checked>
                        <label for="format-mode-preset" class="mode-radio"></label>
                    </div>

                    <div class="mode-option" data-mode="few-shot">
                        <div class="mode-icon">📚</div>
                        <div class="mode-info">
                            <h4>Few-Shot格式学习</h4>
                            <p>上传格式模板文档，AI自动学习其格式规范</p>
                        </div>
                        <input type="radio" name="format-mode" value="few-shot" id="format-mode-few-shot">
                        <label for="format-mode-few-shot" class="mode-radio"></label>
                    </div>
                </div>
            </div>

            <!-- 步骤2: 预设格式配置 -->
            <div class="workflow-block" id="format-preset-config" style="display: block;">
                <h3 class="workflow-title">🎯 预设格式模板库</h3>

                <div class="preset-styles-gallery" id="preset-formats-container">
                    <!-- 格式模板将通过JavaScript动态加载 -->
                    <div class="loading-placeholder">正在加载格式模板...</div>
                </div>

                <div class="format-config-panel">
                    <div class="input-group">
                        <label for="format-action">处理类型:</label>
                        <select class="input-select" id="format-action">
                            <option value="格式对齐">格式对齐</option>
                            <option value="格式转换">格式转换</option>
                            <option value="格式优化">格式优化</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="format-strength">对齐强度:</label>
                        <input type="range" id="format-strength" min="0.1" max="1.0" step="0.1" value="0.7" class="temperature-slider">
                        <span class="temperature-value">0.7</span>
                        <div class="temperature-labels">
                            <span>保守</span>
                            <span>严格</span>
                        </div>
                    </div>

                    <div class="input-group">
                        <label for="format-language">语言模式:</label>
                        <select class="input-select" id="format-language">
                            <option value="auto">自动识别</option>
                            <option value="zh">中文</option>
                            <option value="en">English</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- 步骤2: Few-Shot格式配置 -->
            <div class="workflow-block" id="format-few-shot-config" style="display: none;">
                <h3 class="workflow-title">📚 Few-Shot格式学习</h3>

                <div class="input-group">
                    <label for="upload-format-template">格式模板文档:</label>
                    <div class="file-upload-area" id="format-template-upload">
                        <input type="file" accept=".docx,.doc,.txt,.rtf,.pdf" id="upload-format-template"
                               title="选择格式模板文档" aria-label="上传格式模板文档">
                        <div class="file-upload-text">点击或拖拽上传格式模板文档</div>
                        <div class="file-upload-hint">AI将学习此文档的格式规范</div>
                    </div>
                </div>

                <div class="input-group">
                    <label for="format-description">格式描述 (可选):</label>
                    <textarea id="format-description" class="input-textarea" rows="3"
                              placeholder="描述您希望学习的格式特点，如：正式的公文格式、学术论文格式等..."></textarea>
                </div>

                <div class="input-group">
                    <label for="few-shot-format-strength">学习强度:</label>
                    <input type="range" id="few-shot-format-strength" min="0.3" max="1.0" step="0.1" value="0.7" class="temperature-slider">
                    <span class="few-shot-temperature-value">0.7</span>
                    <div class="temperature-labels">
                        <span>严格模仿</span>
                        <span>灵活学习</span>
                    </div>
                </div>
            </div>

            <!-- 步骤3: 文档上传 -->
            <div class="workflow-block" id="format-document-upload">
                <h3 class="workflow-title">📄 上传待处理文档</h3>

                <!-- 移除标签页，直接显示文件上传 -->

                <div class="input-group">
                    <label for="upload-format-document">选择文档:</label>
                    <div class="file-upload-area" id="format-document-upload-area">
                        <input type="file" accept=".docx,.doc,.txt,.rtf,.pdf" id="upload-format-document"
                               title="选择待处理文档" aria-label="上传待处理文档">
                        <div class="file-upload-text">点击或拖拽上传待处理文档</div>
                        <div class="file-upload-hint">支持 .docx, .doc, .txt, .rtf, .pdf 格式</div>
                    </div>
                </div>


            </div>

            <!-- 步骤4: 开始处理 -->
            <div class="workflow-block" id="format-processing-start">
                <h3 class="workflow-title">🚀 开始格式对齐</h3>

                <div class="input-group">
                    <label for="preserve-content">内容保持选项:</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="preserve-structure" checked>
                            <span class="checkmark"></span>
                            保持文档结构
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="preserve-images" checked>
                            <span class="checkmark"></span>
                            保持图片位置
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="preserve-tables" checked>
                            <span class="checkmark"></span>
                            保持表格格式
                        </label>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" id="start-format-alignment" disabled>
                        🔍 开始格式对齐
                    </button>
                    <button class="btn btn-secondary" id="clear-format-content"
                            aria-label="清空内容">
                        <span>🗑️</span> 清空内容
                    </button>
                </div>
            </div>

            <!-- 步骤4: 处理进度 (取消预览对比功能) -->
            <div class="workflow-block" id="format-comparison-preview" style="display: none;">
                <h3 class="workflow-title">⚡ 处理进度</h3>

                <!-- 进度条 -->
                <div class="progress-container" id="format-progress-container" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="format-progress-fill"></div>
                    </div>
                    <div class="progress-text" id="format-progress-text">正在处理...</div>
                </div>

                <!-- 隐藏对比预览容器 -->
                <div class="comparison-container" id="format-comparison-container" style="display: none;">
                    <!-- 预览功能已取消 -->
                </div>

                <!-- 处理完成提示 -->
                <div class="completion-message" style="text-align: center; padding: 20px; background: #f0f9ff; border-radius: 8px; margin: 20px 0;">
                    <div style="font-size: 48px; margin-bottom: 10px;">✅</div>
                    <h4 style="color: #0369a1; margin-bottom: 10px;">格式对齐完成</h4>
                    <p style="color: #64748b;">处理完成，请在下方导出结果</p>
                </div>
            </div>

            <!-- 步骤4: 导出结果 -->
            <div class="workflow-block" id="format-export-results" style="display: none;">
                <h3 class="workflow-title">📥 导出处理结果</h3>

                <div class="export-options">
                    <div class="export-format-selector">
                        <label>导出格式:</label>
                        <div class="format-buttons">
                            <button class="btn btn-outline" data-format="txt">📄 TXT</button>
                            <button class="btn btn-outline" data-format="docx">📘 DOCX</button>
                            <button class="btn btn-outline" data-format="html">🌐 HTML</button>
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-success" id="download-formatted-document">
                        <span>📥</span> 下载格式化文档
                    </button>
                    <button class="btn btn-secondary" id="restart-format-process">
                        <span>🔄</span> 重新开始
                    </button>
                </div>
            </div>
        </section>

        <!-- 文风统一场景 - 重新设计 -->
        <section id="scene-style" class="scene-section hidden">
            <h2 class="scene-title">🎨 AI文风统一</h2>
            <p class="scene-description">基于星火X1大模型的智能文风统一系统，支持预设风格生成和Few-Shot风格学习</p>

            <!-- 5步工作流程指示器 -->
            <div class="step-indicator" role="progressbar" aria-label="文风统一进度">
                <div class="step-item active">
                    <div class="step-number">1</div>
                    <span>选择模式</span>
                </div>
                <div class="step-line"></div>
                <div class="step-item">
                    <div class="step-number">2</div>
                    <span>配置风格</span>
                </div>
                <div class="step-line"></div>
                <div class="step-item">
                    <div class="step-number">3</div>
                    <span>输入内容</span>
                </div>
                <div class="step-line"></div>
                <div class="step-item">
                    <div class="step-number">4</div>
                    <span>导出应用</span>
                </div>
            </div>

            <!-- 步骤1: 处理模式选择 -->
            <div class="workflow-block" id="style-mode-selection">
                <h3 class="workflow-title">📋 选择处理模式</h3>

                <div class="mode-selector">
                    <div class="mode-option" data-mode="preset">
                        <div class="mode-icon">🎯</div>
                        <div class="mode-info">
                            <h4>预设风格生成</h4>
                            <p>使用内置的专业风格模板（学术、商务、幽默等）</p>
                        </div>
                        <input type="radio" name="style-mode" value="preset" id="mode-preset" checked>
                        <label for="mode-preset" class="mode-radio"></label>
                    </div>

                    <div class="mode-option" data-mode="few-shot">
                        <div class="mode-icon">📚</div>
                        <div class="mode-info">
                            <h4>Few-Shot风格学习</h4>
                            <p>上传参考文档，AI自动学习其写作风格</p>
                        </div>
                        <input type="radio" name="style-mode" value="few-shot" id="mode-few-shot">
                        <label for="mode-few-shot" class="mode-radio"></label>
                    </div>
                </div>
            </div>

            <!-- 步骤2: 预设风格配置 -->
            <div class="workflow-block" id="style-preset-config" style="display: block;">
                <h3 class="workflow-title">🎨 预设风格模板库</h3>

                <div class="preset-styles-gallery" id="preset-styles-container">
                    <!-- 预设风格将通过JavaScript动态加载 -->
                    <div class="loading-placeholder">正在加载预设风格...</div>
                </div>

                <div class="style-config-panel">
                    <div class="input-group">
                        <label for="style-action">操作类型:</label>
                        <select class="input-select" id="style-action">
                            <option value="重写">重写</option>
                            <option value="改写">改写</option>
                            <option value="润色">润色</option>
                            <option value="优化">优化</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="style-temperature">风格强度:</label>
                        <input type="range" id="style-temperature" min="0.1" max="1.0" step="0.1" value="0.7" class="temperature-slider">
                        <span class="temperature-value">0.7</span>
                        <div class="temperature-labels">
                            <span>保守</span>
                            <span>创新</span>
                        </div>
                    </div>

                    <div class="input-group">
                        <label for="style-language">语言模式:</label>
                        <select class="input-select" id="style-language">
                            <option value="auto">自动识别</option>
                            <option value="zh">中文</option>
                            <option value="en">English</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- 步骤2: Few-Shot风格配置 -->
            <div class="workflow-block" id="style-few-shot-config" style="display: none;">
                <h3 class="workflow-title">📚 Few-Shot风格学习</h3>

                <div class="input-group">
                    <label for="upload-reference-doc">参考文档:</label>
                    <div class="file-upload-area" id="reference-doc-upload">
                        <input type="file" accept=".txt" id="upload-reference-doc"
                               title="选择TXT格式参考文档" aria-label="上传TXT格式参考文档">
                        <div class="file-upload-text">点击或拖拽上传纯文本TXT格式参考文档</div>
                        <div class="file-upload-hint">仅支持纯文本TXT格式，最大10MB，AI将学习此文档的写作风格</div>
                    </div>
                </div>

                <div class="input-group">
                    <label for="style-description">风格描述 (可选):</label>
                    <textarea id="style-description" class="input-textarea" rows="3"
                              placeholder="描述您希望学习的风格特点，如：正式的商务语言、轻松的对话风格等..."></textarea>
                </div>

                <div class="input-group">
                    <label for="few-shot-temperature">学习强度:</label>
                    <input type="range" id="few-shot-temperature" min="0.3" max="1.0" step="0.1" value="0.7" class="temperature-slider">
                    <span class="few-shot-temperature-value">0.7</span>
                    <div class="temperature-labels">
                        <span>严格模仿</span>
                        <span>灵活学习</span>
                    </div>
                </div>
            </div>

            <!-- 步骤3: 内容输入 -->
            <div class="workflow-block" id="style-content-input">
                <h3 class="workflow-title">📝 输入要处理的内容</h3>

                <div class="content-input-tabs">
                    <button class="tab-button active" data-tab="text-input">文本输入</button>
                    <button class="tab-button" data-tab="file-upload">文件上传</button>
                </div>

                <div class="tab-content" id="style-text-input-tab">
                    <div class="input-group">
                        <label for="style-content-text">输入文本内容:</label>
                        <textarea id="style-content-text" class="input-textarea content-textarea" rows="8"
                                  placeholder="请输入您要进行风格转换的文本内容..."></textarea>
                        <div class="char-counter">
                            <span id="char-count">0</span> / 2000 字符
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="style-file-upload-tab" style="display: none;">
                    <div class="input-group">
                        <label for="upload-content-file">上传文档:</label>
                        <div class="file-upload-area" id="content-file-upload">
                            <input type="file" accept=".docx,.doc,.txt,.rtf,.pdf" id="upload-content-file"
                                   title="选择要处理的文档" aria-label="上传要处理的文档">
                            <div class="file-upload-text">点击或拖拽上传要处理的文档</div>
                            <div class="file-upload-hint">支持 .docx, .doc, .txt, .rtf, .pdf 格式</div>
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" id="start-style-processing"
                            aria-label="开始风格处理">
                        <span>🚀</span> 开始处理
                    </button>
                    <button class="btn btn-secondary" id="clear-content"
                            aria-label="清空内容">
                        <span>🗑️</span> 清空内容
                    </button>
                </div>

                <div class="feedback-message" id="style-feedback" role="status" aria-live="polite"></div>
            </div>

            <!-- 步骤4: 处理进度 (取消预览对比功能) -->
            <div class="workflow-block" id="style-processing-area" style="display: none;">
                <h3 class="workflow-title">⚡ 处理进度</h3>

                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="style-progress-fill"></div>
                    </div>
                    <div class="progress-text">
                        <span id="style-progress-percent">0%</span>
                        <span id="style-progress-message">准备开始...</span>
                    </div>
                </div>

                <div class="processing-controls">
                    <button class="btn btn-warning" id="cancel-processing" style="display: none;">
                        <span>⏹️</span> 取消处理
                    </button>
                </div>

                <!-- 处理完成提示 -->
                <div class="completion-message" id="style-completion-message" style="display: none; text-align: center; padding: 20px; background: #f0f9ff; border-radius: 8px; margin: 20px 0;">
                    <div style="font-size: 48px; margin-bottom: 10px;">✅</div>
                    <h4 style="color: #0369a1; margin-bottom: 10px;">文风统一完成</h4>
                    <p style="color: #64748b;">处理完成，请在下方选择导出格式</p>
                </div>
            </div>

            <!-- 隐藏原有的结果预览和对比功能 -->
            <div class="workflow-block" id="style-result-area" style="display: none;">
                <!-- 预览对比功能已取消 -->
            </div>

            <!-- 步骤4: 导出选项 -->
            <div class="workflow-block" id="style-export-area" style="display: none;">
                <h3 class="workflow-title">📥 导出选项</h3>

                <div class="export-options">
                    <div class="export-format-group">
                        <h4>选择导出格式:</h4>
                        <div class="format-options">
                            <label class="format-option">
                                <input type="radio" name="export-format" value="txt" checked>
                                <span class="format-icon">📄</span>
                                <span class="format-name">TXT</span>
                            </label>
                            <label class="format-option">
                                <input type="radio" name="export-format" value="docx">
                                <span class="format-icon">📘</span>
                                <span class="format-name">DOCX</span>
                            </label>
                        </div>
                    </div>

                    <div class="export-actions">
                        <button class="btn btn-success btn-large" id="confirm-export">
                            <span>📥</span> 确认导出
                        </button>
                        <button class="btn btn-secondary" id="back-to-result">
                            <span>←</span> 返回结果
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- 智能填报场景 -->
        <section id="scene-fill" class="scene-section hidden">
            <h2 class="scene-title">🤖 智能填报 - 星火X1增强版</h2>
            <p class="scene-description">基于星火X1大模型的智能填报系统，专注于年度总结和简历生成功能</p>

            <!-- 3步工作流程指示器 -->
            <div class="step-indicator" role="progressbar" aria-label="智能填报进度">
                <div class="step-item active">
                    <div class="step-number">1</div>
                    <span>选择生成方式</span>
                </div>
                <div class="step-line"></div>
                <div class="step-item">
                    <div class="step-number">2</div>
                    <span>输入内容</span>
                </div>
                <div class="step-line"></div>
                <div class="step-item">
                    <div class="step-number">3</div>
                    <span>生成导出</span>
                </div>
            </div>

            <!-- 步骤1: 生成方式选择 -->
            <div class="workflow-block" id="fill-mode-selection">
                <h3 class="workflow-title">📋 选择生成方式</h3>

                <div class="mode-selector">
                    <div class="mode-option" data-mode="resume">
                        <div class="mode-icon">👤</div>
                        <div class="mode-info">
                            <h4>简历生成</h4>
                            <p>根据个人信息自动生成格式化的专业简历</p>
                        </div>
                        <input type="radio" name="fill-mode" value="resume" id="mode-resume" checked>
                        <label for="mode-resume" class="mode-radio"></label>
                    </div>

                    <div class="mode-option" data-mode="summary">
                        <div class="mode-icon">📝</div>
                        <div class="mode-info">
                            <h4>年度总结生成</h4>
                            <p>基于工作内容描述生成专业的年度工作总结</p>
                        </div>
                        <input type="radio" name="fill-mode" value="summary" id="mode-summary">
                        <label for="mode-summary" class="mode-radio"></label>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="selectFillMode()">
                        <span>➡️</span> 下一步
                    </button>
                </div>
            </div>



            <!-- 步骤2: 简历生成输入 -->
            <div class="workflow-block" id="resume-input-section" style="display: none;">
                <h3 class="workflow-title">👤 简历信息输入</h3>
                <p>请输入您的个人信息，系统将自动生成格式化的专业简历：</p>

                <div class="input-group">
                    <label for="resume-input">个人信息:</label>
                    <textarea class="input-textarea" id="resume-input" rows="8"
                              placeholder="请输入个人信息，例如：
张三，联系电话：138xxxx8888，邮箱：zhangsan@email.com

教育背景：
2018-2022年就读于北京大学计算机科学与技术专业，获得学士学位

工作经验：
2022年7月至今在腾讯科技有限公司担任软件工程师
主要负责微信支付系统的后端开发和维护
使用Java、Spring Boot、MySQL、Redis等技术栈

项目经验：
支付风控系统（2023.3-2023.8）
担任核心开发工程师，负责实时风险识别模块
技术栈：Java、Kafka、Elasticsearch
实现毫秒级风险评估，降低欺诈交易率30%

专业技能：
编程语言：Java、Python、JavaScript
框架：Spring Boot、Django、React
数据库：MySQL、Redis、MongoDB
工具：Git、Docker、Jenkins"
                              title="输入个人信息" aria-label="输入个人信息"></textarea>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="goBackToModeSelection()">
                        <span>⬅️</span> 上一步
                    </button>
                    <button class="btn btn-primary" onclick="generateResume()" id="resume-btn">
                        <span>👤</span> 生成简历
                    </button>
                </div>

                <div class="loading-indicator" id="resume-loading" style="display: none;">
                    <div class="spinner"></div>
                    <span>正在生成简历，请稍候...</span>
                </div>

                <div class="feedback-message" id="resume-result" role="status" aria-live="polite"></div>
            </div>

            <!-- 步骤2: 年度总结生成输入 -->
            <div class="workflow-block" id="summary-input-section" style="display: none;">
                <h3 class="workflow-title">📝 年度总结信息输入</h3>
                <p>请输入您的工作内容描述，系统将自动生成专业的年度工作总结：</p>

                <div class="input-group">
                    <label for="summary-input">工作内容:</label>
                    <textarea class="input-textarea" id="summary-input" rows="6"
                              placeholder="请输入工作内容，例如：
今年我主要负责了公司核心产品的技术升级工作，成功完成了从单体架构到微服务架构的转型。
在项目管理方面，我带领5人团队完成了3个重要项目，项目按时交付率达到100%。
技术方面，我深入学习了云原生技术，包括Docker、Kubernetes等。
遇到的主要挑战是系统迁移过程中的数据一致性问题，通过设计分布式事务方案得到解决。
明年计划继续深化在AI和大数据方向的技术能力。"
                              title="输入工作内容" aria-label="输入工作内容"></textarea>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="goBackToModeSelection()">
                        <span>⬅️</span> 上一步
                    </button>
                    <button class="btn btn-primary" onclick="generateSummary()" id="summary-btn">
                        <span>📝</span> 生成年度总结
                    </button>
                </div>

                <div class="loading-indicator" id="summary-loading" style="display: none;">
                    <div class="spinner"></div>
                    <span>正在生成年度总结，请稍候...</span>
                </div>

                <div class="feedback-message" id="summary-result" role="status" aria-live="polite"></div>
            </div>

            <!-- 步骤3: 统一导出区域 -->
            <div class="workflow-block" id="fill-export-section" style="display: none;">
                <h3 class="workflow-title">📥 导出生成结果</h3>

                <div class="export-options">
                    <div class="export-format-selector">
                        <label>导出格式:</label>
                        <div class="format-buttons">
                            <button class="btn btn-outline" data-format="docx">📘 DOCX</button>
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-success" id="download-fill-result">
                        <span>📥</span> 下载文件
                    </button>
                    <button class="btn btn-secondary" onclick="restartFillProcess()">
                        <span>🔄</span> 重新开始
                    </button>
                </div>
            </div>
        </section>

        <!-- 文档审查场景 -->
        <section id="scene-review" class="scene-section hidden">
            <h2 class="scene-title">🔍 AI文档审查</h2>
            <p class="scene-description">智能文档审查系统，自动识别关键词和日期信息</p>

            <!-- 步骤指示器 -->
            <div class="step-indicator" role="progressbar" aria-label="文档审查进度">
                <div class="step-item active">
                    <div class="step-number">1</div>
                    <span>设置审查</span>
                </div>
                <div class="step-line"></div>
                <div class="step-item">
                    <div class="step-number">2</div>
                    <span>输入内容</span>
                </div>
                <div class="step-line"></div>
                <div class="step-item">
                    <div class="step-number">3</div>
                    <span>智能审查</span>
                </div>
                <div class="step-line"></div>
                <div class="step-item">
                    <div class="step-number">4</div>
                    <span>导出报告</span>
                </div>
            </div>

            <!-- 步骤1: 审查设置 -->
            <div class="workflow-block" id="review-settings">
                <h3 class="workflow-title">⚙️ 审查设置</h3>

                <div class="review-info">
                    <div class="info-item">
                        <div class="info-icon">🔍</div>
                        <div class="info-content">
                            <h4>关键词审查</h4>
                            <p>自动识别并标记文档中的指定关键词</p>
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label for="review-keywords">要审查的关键词（用逗号分隔）:</label>
                    <input type="text" class="input-field" id="review-keywords"
                           placeholder="例如：合同,协议,金额,截止日期"
                           title="输入要审查的关键词" aria-label="输入要审查的关键词">
                </div>
            </div>



            <!-- 步骤2: 内容输入 -->
            <div class="workflow-block" id="review-content-input">
                <h3 class="workflow-title">📄 输入待审查内容</h3>

                <div class="tab-container">
                    <div class="tab-buttons">
                        <button class="tab-button active" data-tab="text-input">文本输入</button>
                        <button class="tab-button" data-tab="file-upload">文件上传</button>
                    </div>

                    <div class="tab-content review-tab-content">
                        <!-- 文本输入标签页 -->
                        <div class="tab-pane active" id="review-text-input-tab">
                            <div class="input-group">
                                <label for="review-content-text">文档内容:</label>
                                <textarea class="input-textarea" id="review-content-text"
                                          placeholder="请输入需要审查的文档内容..."
                                          rows="8"
                                          title="输入文档内容" aria-label="输入待审查的文档内容"></textarea>
                            </div>
                        </div>

                        <!-- 文件上传标签页 -->
                        <div class="tab-pane" id="review-file-upload-tab">
                            <div class="input-group">
                                <label for="upload-review-content-file">上传文档:</label>
                                <div class="file-upload-area" id="review-content-upload">
                                    <input type="file" accept=".txt" id="upload-review-content-file"
                                           title="选择TXT文档文件" aria-label="上传TXT文档文件">
                                    <div class="file-upload-text">点击或拖拽上传TXT文档文件</div>
                                    <div class="file-upload-hint">仅支持 .txt 格式</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 步骤3: 操作块 -->
            <div class="action-block" id="review-action-block">
                <h3 class="workflow-title">🚀 开始审查</h3>
                <div class="action-buttons">
                    <button class="btn btn-primary" id="start-review-processing"
                            aria-label="开始文档审查">
                        <span>🔍</span> 开始审查
                    </button>
                    <button class="btn btn-secondary" data-action="reset_review"
                            aria-label="重置审查">
                        <span>🔄</span> 重置
                    </button>
                </div>

                <div class="feedback-message" id="review-feedback" role="status" aria-live="polite"></div>
            </div>

            <!-- 步骤4: 处理进度区域 -->
            <div class="workflow-block hidden" id="review-processing-area">
                <h3 class="workflow-title">⏳ 正在审查文档...</h3>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="review-progress-fill"></div>
                    </div>
                    <div class="progress-text" id="review-progress-text">准备开始审查...</div>
                </div>
            </div>

            <!-- 步骤5: 结果展示区域 -->
            <div class="workflow-block hidden" id="review-result-area">
                <h3 class="workflow-title">📋 审查结果</h3>
                <div class="result-container">
                    <div id="review-result-content" role="region" aria-label="文档审查结果"></div>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-success" data-action="export_review_word"
                            aria-label="导出Word报告">
                        <span>📝</span> 导出Word报告
                    </button>
                </div>
            </div>
        </section>


    </div>

    <!-- 通知容器 -->
    <div class="notification-container" id="notification-container" role="status" aria-live="polite" aria-label="通知消息"></div>

    <!-- 加载状态 -->
    <div class="loading" id="global-loading" style="display: none;" role="status" aria-live="polite" aria-label="加载状态">
        <div class="loading-spinner"></div>
        <div class="loading-message" id="loading-message">处理中...</div>
    </div>

    <!-- 脚本引用 -->
    <script src="/static/js/enhanced-frontend-complete.js"></script>

    <!-- 智能填报功能脚本 -->
    <script>
        // 检查智能填报系统状态
        async function checkSmartFillStatus() {
            try {
                const response = await fetch('/api/smart-fill/status');
                const data = await response.json();

                const statusDisplay = document.getElementById('status-display');

                if (data.success) {
                    const status = data.data;
                    statusDisplay.innerHTML = `
                        <div class="status-success">
                            <h4>✅ 系统状态正常</h4>
                            <p><strong>星火X1状态:</strong> ${status.spark_x1_available ? '✅ 可用' : '❌ 不可用'}</p>
                            <p><strong>核心组件:</strong> ${status.core_components_available ? '✅ 可用' : '❌ 不可用'}</p>
                            <p><strong>集成模式:</strong> ${status.integration_mode || 'standard'}</p>
                            <p><strong>支持类型:</strong> ${status.supported_types ? status.supported_types.join(', ') : 'N/A'}</p>
                            <p><strong>版本:</strong> ${status.version}</p>
                            ${status.spark_x1_connection ? `<p><strong>API连接:</strong> ${status.spark_x1_connection}</p>` : ''}
                            <p><strong>检查时间:</strong> ${new Date(status.timestamp).toLocaleString()}</p>
                        </div>
                    `;
                } else {
                    statusDisplay.innerHTML = `<div class="status-error">❌ 状态检查失败: ${data.error}</div>`;
                }
            } catch (error) {
                document.getElementById('status-display').innerHTML = `<div class="status-error">❌ 状态检查异常: ${error.message}</div>`;
            }
        }

        // 智能填报模块的全局变量
        let currentFillMode = 'resume'; // 默认选中简历生成
        let currentFillResult = null;

        // 选择生成方式
        function selectFillMode() {
            const selectedMode = document.querySelector('input[name="fill-mode"]:checked').value;
            currentFillMode = selectedMode;

            // 隐藏模式选择区域
            document.getElementById('fill-mode-selection').style.display = 'none';

            // 显示对应的输入区域
            if (selectedMode === 'resume') {
                document.getElementById('resume-input-section').style.display = 'block';
            } else if (selectedMode === 'summary') {
                document.getElementById('summary-input-section').style.display = 'block';
            }

            // 更新步骤指示器
            updateFillStepIndicator(2);
        }

        // 返回模式选择
        function goBackToModeSelection() {
            // 隐藏所有输入区域
            document.getElementById('resume-input-section').style.display = 'none';
            document.getElementById('summary-input-section').style.display = 'none';
            document.getElementById('fill-export-section').style.display = 'none';

            // 显示模式选择区域
            document.getElementById('fill-mode-selection').style.display = 'block';

            // 更新步骤指示器
            updateFillStepIndicator(1);
        }

        // 重新开始流程
        function restartFillProcess() {
            // 重置所有区域
            document.getElementById('fill-export-section').style.display = 'none';
            document.getElementById('resume-input-section').style.display = 'none';
            document.getElementById('summary-input-section').style.display = 'none';
            document.getElementById('fill-mode-selection').style.display = 'block';

            // 清空结果
            document.getElementById('resume-result').innerHTML = '';
            document.getElementById('summary-result').innerHTML = '';
            currentFillResult = null;

            // 重置步骤指示器
            updateFillStepIndicator(1);
        }

        // 更新步骤指示器
        function updateFillStepIndicator(activeStep) {
            const steps = document.querySelectorAll('#scene-fill .step-item');
            steps.forEach((step, index) => {
                if (index + 1 <= activeStep) {
                    step.classList.add('active');
                } else {
                    step.classList.remove('active');
                }
            });
        }

        // 生成年度总结
        async function generateSummary() {
            const content = document.getElementById('summary-input').value.trim();

            if (!content) {
                alert('请输入工作内容');
                return;
            }

            const btn = document.getElementById('summary-btn');
            const loading = document.getElementById('summary-loading');
            const result = document.getElementById('summary-result');

            btn.disabled = true;
            loading.style.display = 'block';
            result.style.display = 'none';

            // 添加进度条效果
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 90) progress = 90;
                loading.innerHTML = `
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%"></div>
                        </div>
                        <div class="progress-text">正在生成年度总结... ${Math.round(progress)}%</div>
                    </div>
                `;
            }, 500);

            try {
                const response = await fetch('/api/smart-fill/generate-summary', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        content: content,
                        api_password: 'NJFASGuFsRYYjeyLpZFk:jhjQJHHgIeoKVzbAORPh'
                    })
                });

                const data = await response.json();

                if (data.success) {
                    result.className = 'feedback-message success';
                    result.innerHTML = `
                        <h4>✅ 年度总结生成成功</h4>
                        <p><strong>文件名:</strong> ${data.filename}</p>
                        ${data.usage ? `<p><strong>Token使用:</strong> ${data.usage.total_tokens}</p>` : ''}
                    `;

                    // 保存结果信息
                    currentFillResult = {
                        type: 'summary',
                        filename: data.filename,
                        downloadUrl: `/api/smart-fill/download/${data.filename}`
                    };

                    // 隐藏输入区域，显示导出区域
                    document.getElementById('summary-input-section').style.display = 'none';
                    document.getElementById('fill-export-section').style.display = 'block';

                    // 更新步骤指示器
                    updateFillStepIndicator(3);
                } else {
                    result.className = 'feedback-message error';
                    result.innerHTML = `<h4>❌ 生成失败</h4><p>${data.error}</p>`;
                }
            } catch (error) {
                result.className = 'feedback-message error';
                result.innerHTML = `<h4>❌ 请求异常</h4><p>${error.message}</p>`;
            } finally {
                clearInterval(progressInterval);
                btn.disabled = false;
                loading.style.display = 'none';
                loading.innerHTML = `
                    <div class="spinner"></div>
                    <span>正在生成年度总结，请稍候...</span>
                `;
                result.style.display = 'block';
            }
        }

        // 生成简历
        async function generateResume() {
            const content = document.getElementById('resume-input').value.trim();

            if (!content) {
                alert('请输入个人信息');
                return;
            }

            const btn = document.getElementById('resume-btn');
            const loading = document.getElementById('resume-loading');
            const result = document.getElementById('resume-result');

            btn.disabled = true;
            loading.style.display = 'block';
            result.style.display = 'none';

            // 添加进度条效果
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 90) progress = 90;
                loading.innerHTML = `
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%"></div>
                        </div>
                        <div class="progress-text">正在生成简历... ${Math.round(progress)}%</div>
                    </div>
                `;
            }, 500);

            try {
                const response = await fetch('/api/smart-fill/generate-resume', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        content: content
                    })
                });

                const data = await response.json();

                if (data.success) {
                    result.className = 'feedback-message success';
                    result.innerHTML = `
                        <h4>✅ 简历生成成功</h4>
                        <p><strong>文件名:</strong> ${data.filename}</p>
                        ${data.usage ? `<p><strong>Token使用:</strong> ${data.usage.total_tokens}</p>` : ''}
                    `;

                    // 保存结果信息
                    currentFillResult = {
                        type: 'resume',
                        filename: data.filename,
                        downloadUrl: `/api/smart-fill/download/${data.filename}`
                    };

                    // 隐藏输入区域，显示导出区域
                    document.getElementById('resume-input-section').style.display = 'none';
                    document.getElementById('fill-export-section').style.display = 'block';

                    // 更新步骤指示器
                    updateFillStepIndicator(3);
                } else {
                    result.className = 'feedback-message error';
                    result.innerHTML = `<h4>❌ 生成失败</h4><p>${data.error}</p>`;
                }
            } catch (error) {
                result.className = 'feedback-message error';
                result.innerHTML = `<h4>❌ 请求异常</h4><p>${error.message}</p>`;
            } finally {
                clearInterval(progressInterval);
                btn.disabled = false;
                loading.style.display = 'none';
                loading.innerHTML = `
                    <div class="spinner"></div>
                    <span>正在生成简历，请稍候...</span>
                `;
                result.style.display = 'block';
            }
        }

        // 导出功能
        document.addEventListener('DOMContentLoaded', function() {
            // 智能填报模式选择点击事件
            const fillModeOptions = document.querySelectorAll('#scene-fill .mode-option');
            fillModeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const radio = this.querySelector('input[type="radio"]');
                    if (radio) {
                        radio.checked = true;
                        // 更新视觉状态
                        fillModeOptions.forEach(opt => opt.classList.remove('selected'));
                        this.classList.add('selected');
                    }
                });
            });

            // 导出格式选择
            const formatButtons = document.querySelectorAll('#scene-fill .format-buttons .btn');
            formatButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // 移除其他按钮的选中状态
                    formatButtons.forEach(btn => btn.classList.remove('active'));
                    // 添加当前按钮的选中状态
                    this.classList.add('active');
                });
            });

            // 下载按钮点击事件
            document.getElementById('download-fill-result').addEventListener('click', async function() {
                console.log('🖱️ 下载按钮被点击');
                console.log('📋 当前填报结果:', currentFillResult);

                if (currentFillResult) {
                    // 获取选中的格式
                    const selectedFormat = document.querySelector('#scene-fill .format-buttons .btn.active');
                    const format = selectedFormat ? selectedFormat.dataset.format : 'txt';
                    console.log('📄 选择的导出格式:', format);

                    // 所有格式都通过导出API处理，确保格式正确
                    {
                        // DOCX和PDF格式导出
                        console.log('🔄 开始调用导出API');
                        try {
                            this.disabled = true;
                            this.innerHTML = '<span>⏳</span> 正在生成...';

                            const requestData = {
                                filename: currentFillResult.filename,
                                format: format,
                                type: currentFillResult.type
                            };
                            console.log('📤 发送API请求:', requestData);

                            const response = await fetch('/api/smart-fill/export', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify(requestData)
                            });

                            console.log('📥 API响应状态:', response.status);

                            if (!response.ok) {
                                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                            }

                            const result = await response.json();
                            console.log('📋 API响应结果:', result);

                            if (result.success) {
                                console.log('✅ 导出成功，开始下载文件');
                                // 下载生成的文件
                                const link = document.createElement('a');
                                link.href = result.download_url;
                                link.download = result.filename;
                                document.body.appendChild(link);
                                link.click();
                                document.body.removeChild(link);
                                console.log('📥 文件下载触发完成');
                            } else {
                                console.error('❌ 导出失败:', result.error);
                                alert('导出失败: ' + result.error);
                            }
                        } catch (error) {
                            console.error('导出失败:', error);
                            alert('导出失败: ' + error.message);
                        } finally {
                            this.disabled = false;
                            this.innerHTML = '<span>📥</span> 下载文件';
                        }
                    }
                } else {
                    alert('没有可导出的结果');
                }
            });

            // 默认选中DOCX格式
            const docxButton = document.querySelector('#scene-fill .format-buttons .btn[data-format="docx"]');
            if (docxButton) {
                docxButton.classList.add('active');
            }
        });
    </script>
</body>
</html>