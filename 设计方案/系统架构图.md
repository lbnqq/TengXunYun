# aiDoc 系统架构图

## 🏗️ 整体架构图

```
┌─────────────────────────────────────────────────────────────┐
│                    用户界面层 (前端)                          │
├─────────────────────────────────────────────────────────────┤
│  格式对齐    │  文风统一    │  智能填报    │  文档审查      │
│     📄       │     ✍️       │     📝       │     🔍        │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    Web服务层 (Flask)                        │
├─────────────────────────────────────────────────────────────┤
│  路由处理    │  请求验证    │  文件管理    │  响应处理      │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    业务逻辑层 (核心模块)                      │
├─────────────────────────────────────────────────────────────┤
│ 格式对齐协调器│ 文风对齐协调器│ 智能填报管理器│ 文档审查协调器 │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    AI服务层 (星火X1)                        │
├─────────────────────────────────────────────────────────────┤
│  格式处理API  │  文风转换API  │  内容生成API  │  文档分析API   │
└─────────────────────────────────────────────────────────────┘
```

## 🔄 数据流程图

### 用户操作流程
```
用户操作 → 前端界面 → 数据验证 → 后端处理 → AI服务 → 结果返回 → 界面展示
```

### 详细数据流
```
1. 用户上传文档/输入文本
   ↓
2. 前端JavaScript验证数据
   ↓
3. 发送请求到Flask后端
   ↓
4. 后端验证和预处理
   ↓
5. 调用对应的协调器模块
   ↓
6. 协调器调用星火X1 API
   ↓
7. AI处理并返回结果
   ↓
8. 后端格式化响应
   ↓
9. 前端展示结果给用户
```

## 📦 模块关系图

```
┌─────────────────┐    ┌─────────────────┐
│   格式对齐模块    │    │   文风统一模块    │
│                │    │                │
│ ┌─────────────┐ │    │ ┌─────────────┐ │
│ │文件上传处理  │ │    │ │预设风格生成  │ │
│ └─────────────┘ │    │ └─────────────┘ │
│ ┌─────────────┐ │    │ ┌─────────────┐ │
│ │格式模板选择  │ │    │ │Few-Shot学习 │ │
│ └─────────────┘ │    │ └─────────────┘ │
│ ┌─────────────┐ │    │ ┌─────────────┐ │
│ │AI格式处理   │ │    │ │AI文风转换   │ │
│ └─────────────┘ │    │ └─────────────┘ │
└─────────────────┘    └─────────────────┘

┌─────────────────┐    ┌─────────────────┐
│   智能填报模块    │    │   文档审查模块    │
│                │    │                │
│ ┌─────────────┐ │    │ ┌─────────────┐ │
│ │年度总结生成  │ │    │ │预设模板审查  │ │
│ └─────────────┘ │    │ └─────────────┘ │
│ ┌─────────────┐ │    │ ┌─────────────┐ │
│ │个人简历生成  │ │    │ │自定义审查   │ │
│ └─────────────┘ │    │ └─────────────┘ │
│ ┌─────────────┐ │    │ ┌─────────────┐ │
│ │内容智能生成  │ │    │ │质量分析报告  │ │
│ └─────────────┘ │    │ └─────────────┘ │
└─────────────────┘    └─────────────────┘
```

## 🔧 技术栈架构

### 前端技术栈
```
┌─────────────────────────────────────┐
│              前端层                  │
├─────────────────────────────────────┤
│ HTML5        │ 页面结构和语义        │
│ CSS3         │ 样式和布局设计        │
│ JavaScript   │ 交互逻辑和动态效果     │
│ Fetch API    │ 与后端通信           │
│ 响应式设计    │ 多设备适配           │
└─────────────────────────────────────┘
```

### 后端技术栈
```
┌─────────────────────────────────────┐
│              后端层                  │
├─────────────────────────────────────┤
│ Python 3.8+  │ 编程语言             │
│ Flask        │ Web框架              │
│ Werkzeug     │ WSGI工具库           │
│ JSON         │ 数据交换格式          │
│ 文件处理      │ 多格式文档支持        │
└─────────────────────────────────────┘
```

### AI服务技术栈
```
┌─────────────────────────────────────┐
│             AI服务层                 │
├─────────────────────────────────────┤
│ 讯飞星火X1   │ 大语言模型           │
│ REST API     │ 服务调用接口         │
│ HTTP/HTTPS   │ 通信协议             │
│ JSON格式     │ 数据传输格式         │
│ 超时控制      │ 请求稳定性保障       │
└─────────────────────────────────────┘
```

## 🗂️ 文件组织架构

```
aiDoc/
├── 📁 src/                     # 后端源代码
│   ├── 🐍 web_app.py          # Flask主应用
│   ├── 📁 core/               # 核心业务模块
│   │   ├── 📁 tools/          # 工具模块
│   │   │   ├── format_alignment_coordinator.py
│   │   │   ├── style_alignment_coordinator.py
│   │   │   ├── simple_smart_fill_manager.py
│   │   │   └── document_review_coordinator.py
│   │   └── 📁 llm_clients/    # AI客户端
│   │       └── spark_x1_client.py
│   └── 📁 api/                # API路由
├── 📁 templates/              # HTML模板
│   └── 🌐 enhanced-frontend-complete.html
├── 📁 static/                 # 静态资源
│   ├── 📁 css/               # 样式文件
│   │   └── 🎨 enhanced-frontend-complete.css
│   ├── 📁 js/                # JavaScript文件
│   │   └── ⚡ enhanced-frontend-complete.js
│   └── 📁 images/            # 图片资源
├── 📁 设计方案/               # 设计文档
└── 📄 README.md              # 项目说明
```

## 🔐 安全架构

### 数据安全
```
┌─────────────────────────────────────┐
│              安全措施                │
├─────────────────────────────────────┤
│ 输入验证      │ 防止恶意输入         │
│ 文件类型检查   │ 限制上传文件格式     │
│ 大小限制      │ 防止大文件攻击       │
│ 超时控制      │ 防止长时间占用资源   │
│ 错误处理      │ 不泄露敏感信息       │
└─────────────────────────────────────┘
```

### 网络安全
```
┌─────────────────────────────────────┐
│              网络安全                │
├─────────────────────────────────────┤
│ HTTPS通信     │ 数据传输加密         │
│ API密钥管理   │ 安全的密钥存储       │
│ 请求限制      │ 防止API滥用          │
│ 跨域控制      │ CORS安全配置         │
└─────────────────────────────────────┘
```

## 📊 性能架构

### 性能优化策略
```
┌─────────────────────────────────────┐
│              性能优化                │
├─────────────────────────────────────┤
│ 异步处理      │ 非阻塞式操作         │
│ 超时控制      │ 避免长时间等待       │
│ 错误恢复      │ 快速失败和恢复       │
│ 资源管理      │ 及时释放系统资源     │
│ 缓存策略      │ 静态资源缓存         │
└─────────────────────────────────────┘
```

---

*这个架构图展示了 aiDoc 系统的整体结构和各个组件之间的关系。如果您需要了解某个特定部分的更多细节，请告诉我！*
