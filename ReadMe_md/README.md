# 智能文档助手 (Intelligent Document Assistant)

## 📜 项目最高宪法

**本项目严格遵循《[AI编程项目终极实践手册](docs/AI编程项目终极实践手册.md)》(2025年1月28日版)作为开发指导原则。**

**📋 快速查阅**: 详见《[项目宪法索引](docs/项目宪法索引.md)》获取完整规范体系

### 核心指导思想
- **AI是卓越的协作者，而非独立思考者** - 人类是最终的质量与责任承担者
- **验证驱动，而非代码驱动** - 所有实现必须以用户需求为出发点
- **工程健壮性与可维护性优先** - 确保系统可用性、稳定性、可扩展性
- **AI的审慎态度** - 警惕AI局限性，强制高置信度审核

### 强制要求
- 所有AI生成代码必须通过L1-L4代码审查
- 高风险区域强制人工审核与验证
- 四位一体自动化校验：接口、页面、AI代码、测试脚本一致性
- 持续集成与三位一体测试：单元、集成、端到端、可用性测试

---

## 🎯 项目定位

**智能文档助手**是一个专注于**文档组装、文风检测和智能审批**的单用户工具，不替代专业工具，而是帮助用户将分散的内容智能组装成高质量的专业文档。

**重要说明**：本系统为**单用户工具**，不支持多人协同编辑，专注于个人用户的文档处理需求。

### 核心价值
- **智能组装**：将分散内容智能组装成专业文档
- **文风检测**：确保文档风格一致性和专业性
- **智能审批**：AI多角色评审，提供专业建议
- **格式标准化**：自动调整文档格式符合行业标准
- **质量保证**：多维度检查确保文档质量

## 🚀 主要功能

### 1. 智能文档组装
- **内容插入** - 智能识别文档结构，将图表、图片等内容插入到最佳位置
- **格式对齐** - 自动统一文档格式，确保专业性和一致性
- **布局优化** - AI建议最佳内容布局和排版

### 2. 文风检测与统一
- **风格分析** - 分析文档风格特征和语言模式
- **一致性检查** - 确保图表说明、标题等与文档风格一致
- **专业术语** - 智能建议专业术语和表达方式
- **语气调整** - 根据文档类型调整语言语气

### 3. 智能审批与质量检查
- **逻辑验证** - 检查图表与文字内容的逻辑一致性
- **格式规范** - 验证文档格式是否符合行业标准
- **质量评估** - AI辅助文档质量评分和建议
- **审批报告** - 生成详细的审批意见和改进建议

### 4. 多场景支持
- **专利文档** - 专利申请书的专业组装和审批
- **项目报告** - 项目文档的格式统一和质量检查
- **商务合同** - 合同文档的规范化和一致性检查
- **学术论文** - 学术文档的格式标准化和内容验证

## 🚀 下一步工作重点

### 1. 高频文档格式智能填报集成
**目标**：集成常见文档类型的智能填报功能，提升用户使用频率

#### 1.1 简历智能填报
- **功能**：根据求职目标岗位自动调整简历格式和内容重点
- **支持格式**：Word、PDF、HTML
- **智能特性**：
  - 岗位匹配度分析
  - 关键词优化建议
  - 格式标准化处理
  - 内容完整性检查

#### 1.2 论文智能填报
- **功能**：根据投稿期刊要求自动调整论文格式
- **支持格式**：LaTeX、Word、PDF
- **智能特性**：
  - 期刊格式模板匹配
  - 引用格式标准化
  - 图表编号自动调整
  - 参考文献格式检查

#### 1.3 公文智能填报
- **功能**：根据公文类型和目标读者调整格式和内容
- **支持格式**：Word、PDF
- **智能特性**：
  - 公文格式标准化
  - 语言风格调整
  - 审批流程标记
  - 保密级别标识

#### 1.4 合同智能填报
- **功能**：根据合同类型和行业要求调整条款和格式
- **支持格式**：Word、PDF
- **智能特性**：
  - 条款完整性检查
  - 法律风险提示
  - 格式标准化
  - 关键信息突出

### 2. AI多角色评审系统
**目标**：根据文档类型和目标，智能选择系统内置角色进行专业评审

#### 2.1 简历评审角色
- **HR专家**：评估简历的岗位匹配度和可读性
- **猎头顾问**：分析简历的市场竞争力和亮点
- **专业技术人员**：评估技术能力和项目经验描述

#### 2.2 论文评审角色
- **专业评审专家**：评估学术质量和创新性
- **期刊编辑**：检查格式规范和投稿要求
- **同行专家**：提供专业领域建议

#### 2.3 公文评审角色
- **目标读者代表**：评估可读性和理解度
- **相关领导**：检查政策一致性和重要性
- **律师法务**：审核法律合规性

#### 2.4 合同评审角色
- **专业技术人员**：评估技术条款准确性
- **财务专家**：审核财务条款合理性
- **律师**：检查法律风险点
- **风险管理专家**：评估合同风险等级

### 3. 评审系统架构设计

#### 3.1 角色配置管理
- 建立各角色的专业知识库
- 设计角色特定的评审模板
- 构建评审标准和评分体系

#### 3.2 智能角色选择算法
- 基于文档内容和目标的角色匹配算法
- 考虑角色专业领域和评审重点
- 支持多角色组合评审

#### 3.3 评审流程设计
1. **文档类型识别**：自动识别文档类型
2. **目标分析**：提取文档目标信息
3. **角色选择**：智能选择评审角色
4. **并行评审**：多个角色同时评审
5. **结果整合**：汇总评审意见
6. **优先级排序**：按重要性排序建议

## 🛠️ 技术架构

### 后端技术栈
- **Python 3.12** - 核心开发语言
- **Flask** - Web框架
- **SQLAlchemy** - 数据库ORM
- **PaddleOCR** - 文档识别
- **LLM集成** - 多模型支持（星尘、通义千问等）

### 前端技术栈
- **HTML5/CSS3** - 页面结构和样式
- **JavaScript** - 交互逻辑
- **Bootstrap** - UI组件库

### 核心模块
```
src/
├── core/
│   ├── agent/           # AI代理协调器
│   ├── analysis/        # 文档分析引擎
│   ├── tools/           # 核心工具集
│   ├── knowledge_base/  # 知识库
│   └── monitoring/      # 性能监控
├── llm_clients/         # LLM客户端
└── web_app.py          # Web应用入口
```

## 📦 安装与部署

### 环境要求
- Python 3.8+
- Windows/Linux/macOS
- 8GB+ RAM
- 2GB+ 磁盘空间

### 快速安装
```bash
# 克隆项目
git clone <repository-url>
cd office-doc-agent

# 安装依赖
pip install -r requirements.txt

# 启动服务
python -m src.web_app
```

### 配置说明

#### 1. 配置星火X1 API密钥
```bash
# 复制密钥配置模板
cp config/spark_x1_keys.template.yaml config/spark_x1_keys.yaml

# 编辑配置文件，将 YOUR_ACCESS_KEY:YOUR_SECRET_KEY 替换为您的实际密钥
```

#### 2. 验证配置
```bash
# 查看当前密钥配置
python tools/manage_spark_x1_keys.py --list

# 测试密钥有效性
python tools/manage_spark_x1_keys.py --test
```

#### 3. 密钥管理
```bash
# 更新主密钥
python tools/manage_spark_x1_keys.py --update "新的AK:新的SK"

# 查看配置文件路径
python tools/manage_spark_x1_keys.py --config-path
```

详细的密钥管理说明请参考：[星火X1密钥管理文档](SPARK_X1_KEY_MANAGEMENT.md)

## 🎮 使用指南

### 基本工作流程

#### 1. 文档组装
```
用户操作：
1. 上传文档模板
2. 上传外部内容（图表、图片等）
3. 系统自动分析并建议插入位置
4. 用户确认或调整
5. 系统进行智能组装
```

#### 2. 文风检测
```
系统自动：
1. 分析文档风格特征
2. 检查内容一致性
3. 建议专业术语
4. 调整语言语气
```

#### 3. 智能审批
```
系统检查：
1. 逻辑一致性验证
2. 格式规范性检查
3. 质量评估打分
4. 生成审批报告
```

### 界面功能

#### 格式统一模块
- 上传参考格式文档
- 选择待处理文档
- 自动格式对齐
- 预览和导出结果

#### 文风统一模块
- 分析参考文档风格
- 应用风格到目标文档
- 实时预览调整效果
- 导出统一风格文档

#### 智能填报模块
- 上传文档模板
- 准备数据源
- 自动匹配和填充
- 预览和调整结果

#### 文档评审模块
- 上传待评审文档
- 选择评审重点
- 获取AI评审意见
- 管理修改建议

## 🔧 API接口

### 核心API端点

#### 文档处理
- `POST /api/upload` - 文件上传
- `POST /api/format-alignment` - 格式对齐
- `POST /api/style-alignment` - 文风统一
- `POST /api/document-fill` - 智能填报
- `POST /api/document-review` - 文档评审

#### SVG集成
- `POST /api/svg/generate` - 生成SVG图像
- `POST /api/svg/insert` - 插入SVG到文档

#### 预览和导出
- `GET /api/format-alignment/preview/<session_id>` - 预览格式对齐结果
- `GET /api/style-alignment/export/<session_id>` - 导出文风调整文档
- `GET /api/document-review/export/<review_session_id>` - 导出评审文档

## 🧪 测试

### 运行测试
```bash
# 运行所有测试
python tests/run_comprehensive_tests.py

# 运行SVG集成测试
python tests/test_svg_integration.py

# 运行端到端测试
python tests/run_e2e_tests.py
```

### 测试覆盖
- 单元测试
- 集成测试
- 端到端测试
- 性能测试

## 📊 性能指标

### 处理能力
- 文档大小：支持最大50MB文档
- 并发处理：支持10+并发用户
- 响应时间：平均2-5秒处理时间
- 准确率：格式对齐95%+，文风检测90%+

### 系统资源
- CPU使用率：平均30-50%
- 内存使用：2-4GB
- 磁盘空间：根据文档数量动态增长

## 🤝 贡献指南

### 开发环境设置
1. Fork项目
2. 创建功能分支
3. 编写代码和测试
4. 提交Pull Request

### 代码规范
- 遵循PEP 8 Python代码规范
- 添加适当的注释和文档
- 确保测试覆盖率
- 遵循Git提交规范

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

## 📞 联系我们

- 项目主页：[GitHub Repository]
- 问题反馈：[Issues]
- 功能建议：[Discussions]

## 🎉 致谢

感谢所有为项目做出贡献的开发者和用户！

---

**智能文档助手** - 让文档组装更智能，让质量检查更高效！ 🚀

## 📊 预期效果

### 用户价值
1. **提升文档质量**：专业角色评审确保文档质量
2. **节省时间成本**：自动化评审流程，快速获得专业建议
3. **降低风险**：多角度评审，识别潜在问题
4. **提高成功率**：针对性的改进建议，提升文档效果

### 技术价值
1. **模块化设计**：易于扩展新的文档类型和评审角色
2. **智能化程度高**：自动识别和选择，减少用户操作
3. **可定制性强**：支持角色配置和评审标准调整
4. **质量可控**：评审结果可追溯和验证

### 商业价值
1. **差异化优势**：AI多角色评审是独特功能
2. **用户粘性**：专业评审服务提升用户依赖度
3. **市场竞争力**：覆盖高频文档类型，满足主流需求
4. **扩展潜力**：可扩展到更多文档类型和行业领域

# 关键开发规范（摘要）

- 所有API必须兼容`application/json`和`multipart/form-data`，所有异常都返回结构化JSON，绝不返回HTML或500。
- 前端API调用必须封装为统一工具，所有调用点有异常兜底，用户永不见页面崩溃。
- 自动化测试和CI必须覆盖所有Content-Type分支和异常分支，CI自动校验API协议和调用方式一致性。
- 详细规范见 docs/项目开发规范.md。

# 高频易错点防控归档说明

- 本项目已建立《docs/高频易错点防控与扫描报告.md》作为高频易错点防控归档。
- 每次迭代自查和CI自动校验流程，须参考并更新该报告，确保所有高频易错点持续被防控和自动检测。
- 详见 docs/高频易错点防控与扫描报告.md。