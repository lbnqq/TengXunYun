============================= test session starts =============================
platform win32 -- Python 3.12.0, pytest-8.4.1, pluggy-1.6.0
rootdir: D:\DAIP\contest\office-doc-agent
plugins: anyio-4.9.0, langsmith-0.4.3
collected 11 items

tests\test_e2e_complete_system.py FFF.FF....F

================================== FAILURES ===================================
__________________________ test_style_analysis_file ___________________________

    def test_style_analysis_file():
        driver = webdriver.Firefox()
        try:
            driver.get("http://127.0.0.1:5000")
            driver.find_element(By.CSS_SELECTOR, '[data-scene="style"]').click()
            time.sleep(1)
            upload = driver.find_element(By.ID, "upload-style-ref")
            upload.send_keys(r"D:\\DAIP\\contest\\office-doc-agent\\tests\\test_files\\simple.txt")
            time.sleep(1)
            analyze_btn = driver.find_element(By.ID, "analyze-style-btn")
            analyze_btn.click()
            time.sleep(3)
            result = driver.find_element(By.ID, "style-analysis-result")
            class_str = result.get_attribute("class")
>           assert class_str is not None and 'hidden' not in class_str
E           AssertionError: assert ('result-block hidden' is not None and 'hidden' not in 'result-block hidden'
E             
E             'hidden' is contained here:
E               result-block hidden
E             ?              ++++++)

tests\test_e2e_complete_system.py:379: AssertionError
__________________________ test_style_analysis_text ___________________________

    def test_style_analysis_text():
        driver = webdriver.Firefox()
        try:
            driver.get("http://127.0.0.1:5000")
            driver.find_element(By.CSS_SELECTOR, '[data-scene="style"]').click()
            time.sleep(1)
            text_input = driver.find_element(By.ID, "style-text-input")
            text_input.send_keys("这是待分析的测试文本。")
            analyze_btn = driver.find_element(By.ID, "analyze-text-btn")
            analyze_btn.click()
            time.sleep(3)
            result = driver.find_element(By.ID, "style-analysis-result")
            class_str = result.get_attribute("class")
>           assert class_str is not None and 'hidden' not in class_str
E           AssertionError: assert ('result-block hidden' is not None and 'hidden' not in 'result-block hidden'
E             
E             'hidden' is contained here:
E               result-block hidden
E             ?              ++++++)

tests\test_e2e_complete_system.py:396: AssertionError
________________________ test_fill_and_material_upload ________________________

    def test_fill_and_material_upload():
        driver = webdriver.Firefox()
        try:
            driver.get("http://127.0.0.1:5000")
            driver.find_element(By.CSS_SELECTOR, '[data-scene="fill"]').click()
            time.sleep(1)
            fill_upload = driver.find_element(By.ID, "fill-file-input")
            fill_upload.send_keys(r"D:\\DAIP\\contest\\office-doc-agent\\tests\\test_files\\simple.txt")
            material_upload = driver.find_element(By.ID, "material-file-input")
            material_upload.send_keys(r"D:\\DAIP\\contest\\office-doc-agent\\tests\\test_files\\special_chars.txt")
            time.sleep(1)
            start_btn = driver.find_element(By.ID, "start-fill-btn")
            start_btn.click()
            time.sleep(3)
            result = driver.find_element(By.ID, "fill-result-section")
            class_str = result.get_attribute("class")
>           assert class_str is not None and 'hidden' not in class_str
E           AssertionError: assert ('result-block hidden' is not None and 'hidden' not in 'result-block hidden'
E             
E             'hidden' is contained here:
E               result-block hidden
E             ?              ++++++)

tests\test_e2e_complete_system.py:416: AssertionError
__________________________ test_analyze_without_file __________________________

    def test_analyze_without_file():
        driver = webdriver.Firefox()
        try:
            driver.get("http://127.0.0.1:5000")
            driver.find_element(By.CSS_SELECTOR, '[data-scene="style"]').click()
            time.sleep(1)
            analyze_btn = driver.find_element(By.ID, "analyze-style-btn")
            analyze_btn.click()
            time.sleep(1)
            # 检查是否有错误提示
            try:
                error = driver.find_element(By.CLASS_NAME, "feedback-message")
>               assert error.is_displayed()
E               assert False
E                +  where False = is_displayed()
E                +    where is_displayed = <selenium.webdriver.remote.webelement.WebElement (session="682534f5-cc00-438d-b273-aedd1736cf67", element="fd416776-063b-4546-9b53-e99d6d532849")>.is_displayed

tests\test_e2e_complete_system.py:440: AssertionError
________________________ test_analyze_unsupported_file ________________________

    def test_analyze_unsupported_file():
        driver = webdriver.Firefox()
        try:
            driver.get("http://127.0.0.1:5000")
            driver.find_element(By.CSS_SELECTOR, '[data-scene="style"]').click()
            time.sleep(1)
            upload = driver.find_element(By.ID, "upload-style-ref")
            # 上传不支持的文件类型
            upload.send_keys(r"D:\\DAIP\\contest\\office-doc-agent\\tests\\test_files\\frontend_test.txt.exe")
            time.sleep(1)
            analyze_btn = driver.find_element(By.ID, "analyze-style-btn")
            analyze_btn.click()
            time.sleep(1)
            try:
                error = driver.find_element(By.CLASS_NAME, "feedback-message")
>               assert error.is_displayed()
E               assert False
E                +  where False = is_displayed()
E                +    where is_displayed = <selenium.webdriver.remote.webelement.WebElement (session="2fdfa34d-7fe1-42fd-b2d6-2d6292b09e74", element="cde00554-89a7-47a1-8b4f-87ba73081598")>.is_displayed

tests\test_e2e_complete_system.py:461: AssertionError
___________________________ test_special_chars_file ___________________________

    def test_special_chars_file():
        driver = webdriver.Firefox()
        try:
            driver.get("http://127.0.0.1:5000")
            driver.find_element(By.CSS_SELECTOR, '[data-scene="style"]').click()
            time.sleep(1)
            upload = driver.find_element(By.ID, "upload-style-ref")
            upload.send_keys(r"D:\\DAIP\\contest\\office-doc-agent\\tests\\test_files\\special_chars.txt")
            time.sleep(1)
            analyze_btn = driver.find_element(By.ID, "analyze-style-btn")
            analyze_btn.click()
            time.sleep(2)
            # 检查是否有分析结果或错误提示
            try:
                result = driver.find_element(By.ID, "style-analysis-result")
                class_str = result.get_attribute("class")
>               assert class_str is not None and 'hidden' not in class_str
E               AssertionError: assert ('result-block hidden' is not None and 'hidden' not in 'result-block hidden'
E                 
E                 'hidden' is contained here:
E                   result-block hidden
E                 ?              ++++++)

tests\test_e2e_complete_system.py:521: AssertionError
=========================== short test summary info ===========================
FAILED tests/test_e2e_complete_system.py::test_style_analysis_file - Assertio...
FAILED tests/test_e2e_complete_system.py::test_style_analysis_text - Assertio...
FAILED tests/test_e2e_complete_system.py::test_fill_and_material_upload - Ass...
FAILED tests/test_e2e_complete_system.py::test_analyze_without_file - assert ...
FAILED tests/test_e2e_complete_system.py::test_analyze_unsupported_file - ass...
FAILED tests/test_e2e_complete_system.py::test_special_chars_file - Assertion...
=================== 6 failed, 5 passed in 65.06s (0:01:05) ====================
