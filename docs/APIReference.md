# åç«¯æ¥å£å¼€å‘æ–‡æ¡£ (2025å¹´6æœˆ26æ—¥)

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£æ—¨åœ¨ç³»ç»Ÿæ¢³ç† Office-Doc-Agent é¡¹ç›®ä¸­å·²å®ç°çš„æ‰€æœ‰åç«¯APIæ¥å£ï¼Œä¸ºå¼€å‘äººå‘˜ã€æµ‹è¯•äººå‘˜åŠç›¸å…³å›¢é˜Ÿæˆå‘˜æä¾›æ¸…æ™°çš„æ¥å£å‚è€ƒã€‚æœ¬æ–‡æ¡£åŸºäºé¡¹ç›®ä»£ç åº“ä¸­çš„å®é™…å®ç°ï¼Œæ¶µç›–äº†APIç«¯ç‚¹çš„åŠŸèƒ½ã€è¯·æ±‚æ–¹æ³•ã€è·¯å¾„ã€å‚æ•°åŠä¸»è¦ç”¨é€”ï¼Œæ—¨åœ¨æ–¹ä¾¿æ¥å£è°ƒç”¨ã€æµ‹è¯•éªŒè¯åŠåç»­ç»´æŠ¤å·¥ä½œã€‚

æœ¬æ¥å£æ–‡æ¡£æŒ‰ç…§åŠŸèƒ½æ¨¡å—å¯¹APIè¿›è¡Œåˆ†ç±»æ•´ç†ï¼ŒåŒ…æ‹¬æ–‡æ¡£å¤„ç†ã€å†™ä½œé£æ ¼åˆ†æã€æ•°æ®åº“æ“ä½œã€æ€§èƒ½ç›‘æ§ã€æ‰¹é‡å¤„ç†ç­‰ä¸»è¦æ¨¡å—ã€‚æ¯ä¸ªæ¨¡å—ä¸‹è¯¦ç»†åˆ—å‡ºç›¸å…³APIç«¯ç‚¹ï¼Œå¹¶æä¾›ç®€è¦æè¿°ä»¥å¸®åŠ©ç†è§£å…¶ä½œç”¨ã€‚æ–‡æ¡£å†…å®¹åŸºäº2025å¹´6æœˆ26æ—¥çš„ä»£ç çŠ¶æ€ç”Ÿæˆï¼Œæœªæ¥å¦‚æœ‰æ¥å£å˜æ›´ï¼Œå°†æ›´æ–°ç›¸åº”ç‰ˆæœ¬ã€‚

**é‡è¦è¯´æ˜**ï¼šæœ¬æ–‡æ¡£åŒæ—¶åŒ…å«åç«¯æ¥å£å®šä¹‰å’Œå‰ç«¯è°ƒç”¨ç¤ºä¾‹ï¼Œç¡®ä¿å‰åç«¯å¼€å‘çš„ä¸€è‡´æ€§ã€‚

## ğŸ“… æ–‡æ¡£ä¿¡æ¯

æœ¬æ¥å£æ–‡æ¡£çš„ç”Ÿæˆæ—¶é—´ä¸º2025å¹´6æœˆ26æ—¥ï¼ŒåŸºäºé¡¹ç›®ä»£ç åº“ä¸­æˆªè‡³è¯¥æ—¥æœŸçš„æœ€æ–°å®ç°ã€‚APIä¿¡æ¯é€šè¿‡å¯¹`src/web_app.py`åŠç›¸å…³æ–‡ä»¶çš„åˆ†ææå–ï¼Œç¡®ä¿å†…å®¹çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§ã€‚æœ¬æ–‡æ¡£éµå¾ªã€ŠAIç¼–ç¨‹é¡¹ç›®ç»ˆæå®è·µæ‰‹å†Œ.mdã€‹ä¸­å¯¹æŠ€æœ¯æ–‡æ¡£ç»“æ„å’Œå†…å®¹çš„è¦æ±‚ï¼Œæ—¨åœ¨ä¸ºé¡¹ç›®å›¢é˜Ÿæä¾›å¯é çš„å‚è€ƒèµ„æ–™ã€‚

åœ¨æ¢³ç†APIæ¥å£çš„è¿‡ç¨‹ä¸­ï¼Œå…±è¯†åˆ«å‡º45ä¸ªç«¯ç‚¹ï¼Œè¦†ç›–äº†ä»åŸºæœ¬å¥åº·æ£€æŸ¥åˆ°å¤æ‚æ–‡æ¡£å¤„ç†çš„å…¨æ–¹ä½åŠŸèƒ½ã€‚ä»¥ä¸‹ç« èŠ‚å°†æŒ‰åŠŸèƒ½æ¨¡å—é€ä¸€å±•å¼€è¯¦ç»†è¯´æ˜ï¼Œä»¥ä¾¿äºå¼€å‘äººå‘˜å¿«é€Ÿå®šä½æ‰€éœ€æ¥å£ã€‚

## ğŸ§  æ™ºèƒ½æ„å›¾è¯†åˆ«APIè¯´æ˜

ç³»ç»Ÿæ”¯æŒç”¨æˆ·ä¸Šä¼ æ–‡æ¡£åï¼Œè‡ªåŠ¨åˆ†ææ–‡æ¡£å†…å®¹å’Œç»“æ„ï¼Œæ™ºèƒ½è¯†åˆ«ç”¨æˆ·æ„å›¾ï¼ˆå¦‚ï¼šç©ºè¡¨æ ¼/æ¨¡æ¿ã€å†…å®¹å®Œæ•´ã€æ ¼å¼æ··ä¹±ã€AIGCç—•è¿¹ç­‰ï¼‰ï¼Œå¹¶åœ¨ç½®ä¿¡åº¦é«˜æ—¶è‡ªåŠ¨æ¨èæˆ–å¼•å¯¼ç”¨æˆ·è¿›å…¥æœ€åˆé€‚çš„ä¸‹ä¸€æ­¥æ“ä½œã€‚è¯¥èƒ½åŠ›ç”±`/api/document-fill/start`ç­‰æ¥å£è‡ªåŠ¨è§¦å‘ï¼Œè¿”å›ç»“æ„ä¸­åŒ…å«æ¨èçš„å¤„ç†ç±»å‹ã€ç½®ä¿¡åº¦ã€å»ºè®®çš„ä¸‹ä¸€æ­¥æ“ä½œç­‰ä¿¡æ¯ã€‚

## ğŸ—ï¸ APIåˆ†ç±»ä¸è¯¦ç»†è¯´æ˜

APIæ¥å£æŒ‰ç…§åŠŸèƒ½æ¨¡å—è¿›è¡Œåˆ†ç±»ï¼Œä»¥ä¾¿äºç†è§£å’Œä½¿ç”¨ã€‚æ¯ä¸ªæ¨¡å—åŒ…å«è‹¥å¹²ç›¸å…³ç«¯ç‚¹ï¼Œæ¶µç›–äº†ä»åŸºæœ¬é¡µé¢è®¿é—®åˆ°å¤æ‚ä¸šåŠ¡é€»è¾‘å¤„ç†çš„ä¸åŒåœºæ™¯ã€‚ä»¥ä¸‹æ˜¯å„æ¨¡å—çš„è¯¦ç»†æè¿°åŠæ¥å£æ¸…å•ã€‚

### é¡µé¢è®¿é—®æ¥å£

é¡µé¢è®¿é—®æ¥å£ä¸»è¦ç”¨äºå‰ç«¯é¡µé¢çš„æ¸²æŸ“å’Œè®¿é—®ï¼Œå±äºåŸºç¡€è·¯ç”±åŠŸèƒ½ã€‚è¿™äº›æ¥å£é€šå¸¸ä¸æ¶‰åŠå¤æ‚ä¸šåŠ¡é€»è¾‘ï¼Œä¸»è¦è´Ÿè´£é¡µé¢å†…å®¹çš„è¿”å›ã€‚

- **GET /**  
  åŠŸèƒ½ï¼šè¿”å›ä¸»é¡µé¢å†…å®¹ï¼Œé€šå¸¸æ˜¯é¡¹ç›®çš„å…¥å£é¡µé¢ã€‚  
  æè¿°ï¼šè¿™æ˜¯ç”¨æˆ·è®¿é—®åº”ç”¨æ—¶çš„é»˜è®¤é¡µé¢ï¼Œå¯èƒ½åŒ…å«åŸºæœ¬çš„å¯¼èˆªå’ŒåŠŸèƒ½ä»‹ç»ã€‚

- **GET /demo**  
  åŠŸèƒ½ï¼šè¿”å›æ¼”ç¤ºé¡µé¢ã€‚  
  æè¿°ï¼šç”¨äºå±•ç¤ºé¡¹ç›®çš„åŸºæœ¬åŠŸèƒ½æˆ–æä¾›æ¼”ç¤ºå†…å®¹ï¼Œé€‚åˆæ–°ç”¨æˆ·äº†è§£åº”ç”¨ç‰¹æ€§ã€‚

- **GET /dashboard**  
  åŠŸèƒ½ï¼šè¿”å›ä»ªè¡¨ç›˜é¡µé¢ã€‚  
  æè¿°ï¼šä»ªè¡¨ç›˜é¡µé¢é€šå¸¸ç”¨äºå±•ç¤ºé¡¹ç›®è¿è¡ŒçŠ¶æ€ã€ç»Ÿè®¡æ•°æ®æˆ–å…³é”®æŒ‡æ ‡ã€‚

- **GET /batch**  
  åŠŸèƒ½ï¼šè¿”å›æ‰¹é‡å¤„ç†é¡µé¢ã€‚  
  æè¿°ï¼šæä¾›æ‰¹é‡ä»»åŠ¡åˆ›å»ºå’Œç®¡ç†çš„å‰ç«¯ç•Œé¢ã€‚

- **GET /debug_frontend.html**  
  åŠŸèƒ½ï¼šè¿”å›è°ƒè¯•å‰ç«¯é¡µé¢ã€‚  
  æè¿°ï¼šç”¨äºå¼€å‘å’Œè°ƒè¯•å‰ç«¯åŠŸèƒ½ï¼Œå¯èƒ½åŒ…å«æµ‹è¯•å·¥å…·æˆ–è°ƒè¯•ä¿¡æ¯ã€‚

- **GET /test_ai_features.html**  
  åŠŸèƒ½ï¼šè¿”å›AIåŠŸèƒ½æµ‹è¯•é¡µé¢ã€‚  
  æè¿°ï¼šä¸“é—¨ç”¨äºæµ‹è¯•AIç›¸å…³åŠŸèƒ½çš„é¡µé¢ï¼Œå¯èƒ½åŒ…å«äº¤äº’å¼æµ‹è¯•å·¥å…·ã€‚

- **GET /examples/<filename>**  
  åŠŸèƒ½ï¼šä¸‹è½½ç¤ºä¾‹æ–‡ä»¶ã€‚  
  æè¿°ï¼šæ ¹æ®æä¾›çš„æ–‡ä»¶åè¿”å›å¯¹åº”çš„ç¤ºä¾‹æ–‡ä»¶ï¼Œé€‚ç”¨äºç”¨æˆ·è·å–æ¨¡æ¿æˆ–å‚è€ƒèµ„æ–™ã€‚

### å¥åº·æ£€æŸ¥ä¸é…ç½®æ¥å£

å¥åº·æ£€æŸ¥ä¸é…ç½®æ¥å£ç”¨äºç›‘æ§åº”ç”¨çŠ¶æ€å’Œè·å–é…ç½®ä¿¡æ¯ï¼Œç¡®ä¿ç³»ç»Ÿæ­£å¸¸è¿è¡Œã€‚è¿™äº›æ¥å£é€šå¸¸ç”¨äºè¿ç»´å’Œè°ƒè¯•ã€‚

- **GET /api/health**  
  åŠŸèƒ½ï¼šè¿”å›åº”ç”¨å¥åº·çŠ¶æ€ã€‚  
  æè¿°ï¼šç”¨äºæ£€æŸ¥åº”ç”¨æ˜¯å¦æ­£å¸¸è¿è¡Œï¼Œé€šå¸¸è¿”å›ç®€å•çš„çŠ¶æ€ä¿¡æ¯ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function checkHealth() {
      try {
          const response = await fetch('/api/health');
          const result = await response.json();
          console.log('åº”ç”¨çŠ¶æ€:', result);
          return result;
      } catch (error) {
          console.error('å¥åº·æ£€æŸ¥å¤±è´¥:', error);
          return null;
      }
  }
  ```

- **GET /api/performance/health**  
  åŠŸèƒ½ï¼šè·å–APIå¥åº·çŠ¶æ€ï¼ˆç¬¬ä¸€é˜¶æ®µæ–°å¢ï¼‰ã€‚  
  æè¿°ï¼šè¿”å›ç³»ç»Ÿå„ç»„ä»¶çš„è¯¦ç»†å¥åº·çŠ¶æ€ï¼ŒåŒ…æ‹¬LLMå®¢æˆ·ç«¯ã€æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿã€ç¼“å­˜ç³»ç»Ÿã€æ¨¡æ¿ç³»ç»Ÿç­‰ã€‚
  
  **å“åº”æ ¼å¼**ï¼š
  ```json
  {
    "success": true,
    "data": {
      "endpoints": [],
      "overall_health": "healthy",
      "last_check": "2025-06-28T17:54:44.761579",
      "llm_client": {"status": "healthy"},
      "database": {"status": "healthy"},
      "file_system": {"status": "healthy"},
      "cache_system": {"status": "healthy"},
      "template_system": {"status": "healthy"}
    }
  }
  ```
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function getApiHealth() {
      try {
          const response = await fetch('/api/performance/health');
          const result = await response.json();
          
          if (result.success) {
              const health = result.data;
              console.log('æ•´ä½“å¥åº·çŠ¶æ€:', health.overall_health);
              console.log('æ•°æ®åº“çŠ¶æ€:', health.database.status);
              console.log('æ–‡ä»¶ç³»ç»ŸçŠ¶æ€:', health.file_system.status);
              return health;
          } else {
              throw new Error(result.error || 'å¥åº·æ£€æŸ¥å¤±è´¥');
          }
      } catch (error) {
          console.error('APIå¥åº·æ£€æŸ¥å¤±è´¥:', error);
          return null;
      }
  }
  ```

- **GET /api/config**  
  åŠŸèƒ½ï¼šè·å–åº”ç”¨é…ç½®ä¿¡æ¯ã€‚  
  æè¿°ï¼šè¿”å›å½“å‰åº”ç”¨çš„é…ç½®å‚æ•°ï¼Œå¯èƒ½åŒ…æ‹¬åŠŸèƒ½å¼€å…³æˆ–ç¯å¢ƒå˜é‡ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function getConfig() {
      try {
          const response = await fetch('/api/config');
          const config = await response.json();
          console.log('åº”ç”¨é…ç½®:', config);
          return config;
      } catch (error) {
          console.error('è·å–é…ç½®å¤±è´¥:', error);
          return null;
      }
  }
  ```

- **GET /api/models**  
  åŠŸèƒ½ï¼šè·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨ã€‚  
  æè¿°ï¼šè¿”å›åº”ç”¨æ”¯æŒçš„AIæ¨¡å‹æˆ–å¤„ç†æ¨¡å‹åˆ—è¡¨ï¼Œä¾›ç”¨æˆ·é€‰æ‹©æˆ–é…ç½®ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function getAvailableModels() {
      try {
          const response = await fetch('/api/models');
          const models = await response.json();
          console.log('å¯ç”¨æ¨¡å‹:', models);
          return models;
      } catch (error) {
          console.error('è·å–æ¨¡å‹åˆ—è¡¨å¤±è´¥:', error);
          return [];
      }
  }
  ```

### æ–‡æ¡£å¤„ç†æ¥å£

æ–‡æ¡£å¤„ç†æ¥å£æ˜¯åº”ç”¨çš„æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼Œæ¶µç›–äº†æ–‡æ¡£ä¸Šä¼ ã€æ ¼å¼å¯¹é½ã€æ¨¡æ¿åº”ç”¨åŠæ–‡æ¡£å¡«å†™ç­‰åŠŸèƒ½ã€‚è¿™äº›æ¥å£æ”¯æŒå¤æ‚çš„ä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚

- **POST /api/upload**  
  åŠŸèƒ½ï¼šä¸Šä¼ æ–‡ä»¶ã€‚  
  æè¿°ï¼šæ¥æ”¶ç”¨æˆ·ä¸Šä¼ çš„æ–‡æ¡£æ–‡ä»¶ï¼Œå¹¶è¿›è¡Œåˆæ­¥å¤„ç†æˆ–å­˜å‚¨ã€‚ä¸Šä¼ åç³»ç»Ÿä¼šè‡ªåŠ¨åˆ†ææ–‡æ¡£å†…å®¹å’Œç»“æ„ï¼Œåˆ¤å®šç”¨æˆ·æ„å›¾ï¼ˆå¦‚æ™ºèƒ½å¡«æŠ¥ã€æ ¼å¼æ•´ç†ã€å†…å®¹è¡¥å…¨ã€é£æ ¼æ”¹å†™ç­‰ï¼‰ï¼Œå¹¶åœ¨ç½®ä¿¡åº¦é«˜æ—¶è‡ªåŠ¨æ¨èä¸‹ä¸€æ­¥æ“ä½œã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function uploadFile(file) {
      try {
          showLoading('æ­£åœ¨ä¸Šä¼ æ–‡ä»¶...');
          
          const formData = new FormData();
          formData.append('file', file);
          
          const response = await fetch('/api/upload', {
              method: 'POST',
              body: formData
          });
          
          if (!response.ok) {
              throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }
          
          const result = await response.json();
          
          if (result.success) {
              showMessage('æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼', 'success');
              return result;
          } else {
              throw new Error(result.error || 'ä¸Šä¼ å¤±è´¥');
          }
          
      } catch (error) {
          showMessage(`ä¸Šä¼ å¤±è´¥: ${error.message}`, 'error');
          return null;
      } finally {
          hideLoading();
      }
  }
  ```

- **POST /api/format-alignment**  
  åŠŸèƒ½ï¼šæ‰§è¡Œæ ¼å¼å¯¹é½æ“ä½œã€‚  
  æè¿°ï¼šæ ¹æ®æŒ‡å®šè§„åˆ™æˆ–æ¨¡æ¿å¯¹ä¸Šä¼ çš„æ–‡æ¡£è¿›è¡Œæ ¼å¼è°ƒæ•´ã€‚

- **GET /api/format-templates**  
  åŠŸèƒ½ï¼šåˆ—å‡ºæ‰€æœ‰æ ¼å¼æ¨¡æ¿ã€‚  
  æè¿°ï¼šè¿”å›å¯ç”¨çš„æ ¼å¼æ¨¡æ¿åˆ—è¡¨ï¼Œä¾›ç”¨æˆ·é€‰æ‹©ã€‚

- **GET /api/format-templates/<template_id>**  
  åŠŸèƒ½ï¼šè·å–æŒ‡å®šæ ¼å¼æ¨¡æ¿çš„è¯¦ç»†ä¿¡æ¯ã€‚  
  æè¿°ï¼šæ ¹æ®æ¨¡æ¿IDè¿”å›è¯¥æ¨¡æ¿çš„å…·ä½“å†…å®¹å’Œé…ç½®ã€‚

- **POST /api/format-templates/<template_id>/apply**  
  åŠŸèƒ½ï¼šåº”ç”¨æŒ‡å®šæ ¼å¼æ¨¡æ¿åˆ°æ–‡æ¡£ã€‚  
  æè¿°ï¼šå°†é€‰å®šçš„æ¨¡æ¿åº”ç”¨åˆ°ç›®æ ‡æ–‡æ¡£ä¸Šï¼Œæ‰§è¡Œæ ¼å¼åŒ–æ“ä½œã€‚

- **GET /api/templates/<template_id>**  
  åŠŸèƒ½ï¼šè·å–æ¨¡æ¿è¯¦ç»†ä¿¡æ¯ï¼ˆç¬¬ä¸€é˜¶æ®µæ–°å¢ï¼‰ã€‚  
  æè¿°ï¼šæ ¹æ®æ¨¡æ¿IDè·å–æ¨¡æ¿çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ¨¡æ¿å†…å®¹ã€æ ¼å¼è§„åˆ™ã€åˆ›å»ºæ—¶é—´ç­‰ã€‚
  
  **å“åº”æ ¼å¼**ï¼š
  ```json
  {
    "success": true,
    "template": {
      "template_id": "template_12345678_abcd1234",
      "template_name": "æ ‡å‡†æŠ¥å‘Šæ¨¡æ¿",
      "format_rules": {...},
      "created_at": "2025-06-28T17:54:44.761579",
      "updated_at": "2025-06-28T17:54:44.761579"
    }
  }
  ```
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function getTemplateDetails(templateId) {
      try {
          const response = await fetch(`/api/templates/${templateId}`);
          const result = await response.json();
          
          if (result.success) {
              console.log('æ¨¡æ¿è¯¦æƒ…:', result.template);
              return result.template;
          } else {
              throw new Error(result.error || 'è·å–æ¨¡æ¿å¤±è´¥');
          }
      } catch (error) {
          console.error('è·å–æ¨¡æ¿è¯¦æƒ…å¤±è´¥:', error);
          return null;
      }
  }
  ```

- **POST /api/templates/<template_id>/apply**  
  åŠŸèƒ½ï¼šåº”ç”¨æ¨¡æ¿åˆ°æ–‡æ¡£å†…å®¹ï¼ˆç¬¬ä¸€é˜¶æ®µæ–°å¢ï¼‰ã€‚  
  æè¿°ï¼šå°†æŒ‡å®šæ¨¡æ¿åº”ç”¨åˆ°æ–‡æ¡£å†…å®¹ï¼Œè¿”å›æ ¼å¼åŒ–åçš„ç»“æœã€‚
  
  **è¯·æ±‚æ ¼å¼**ï¼š
  ```json
  {
    "content": "åŸå§‹æ–‡æ¡£å†…å®¹",
    "options": {
      "preserve_formatting": true,
      "apply_styles": true
    }
  }
  ```
  
  **å“åº”æ ¼å¼**ï¼š
  ```json
  {
    "success": true,
    "result": {
      "formatted_content": "æ ¼å¼åŒ–åçš„å†…å®¹",
      "applied_rules": ["è§„åˆ™1", "è§„åˆ™2"],
      "processing_time": 0.5
    }
  }
  ```
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function applyTemplate(templateId, content, options = {}) {
      try {
          const response = await fetch(`/api/templates/${templateId}/apply`, {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                  content: content,
                  options: options
              })
          });
          
          const result = await response.json();
          
          if (result.success) {
              console.log('æ¨¡æ¿åº”ç”¨æˆåŠŸ:', result.result);
              return result.result;
          } else {
              throw new Error(result.error || 'åº”ç”¨æ¨¡æ¿å¤±è´¥');
          }
      } catch (error) {
          console.error('åº”ç”¨æ¨¡æ¿å¤±è´¥:', error);
          return null;
      }
  }
  ```

- **DELETE /api/templates/<template_id>/delete**  
  åŠŸèƒ½ï¼šåˆ é™¤æŒ‡å®šæ¨¡æ¿ï¼ˆç¬¬ä¸€é˜¶æ®µæ–°å¢ï¼‰ã€‚  
  æè¿°ï¼šæ ¹æ®æ¨¡æ¿IDåˆ é™¤æŒ‡å®šçš„æ¨¡æ¿æ–‡ä»¶å’Œç›¸å…³ç´¢å¼•ã€‚
  
  **å“åº”æ ¼å¼**ï¼š
  ```json
  {
    "success": true,
    "message": "æ¨¡æ¿åˆ é™¤æˆåŠŸ",
    "deleted_template_id": "template_12345678_abcd1234"
  }
  ```
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function deleteTemplate(templateId) {
      try {
          const response = await fetch(`/api/templates/${templateId}/delete`, {
              method: 'DELETE'
          });
          
          const result = await response.json();
          
          if (result.success) {
              console.log('æ¨¡æ¿åˆ é™¤æˆåŠŸ:', result.message);
              return true;
          } else {
              throw new Error(result.error || 'åˆ é™¤æ¨¡æ¿å¤±è´¥');
          }
      } catch (error) {
          console.error('åˆ é™¤æ¨¡æ¿å¤±è´¥:', error);
          return false;
      }
  }
  ```

- **GET /api/format-alignment/preview/<session_id>**  
  åŠŸèƒ½ï¼šé¢„è§ˆæ ¼å¼åŒ–åçš„æ–‡æ¡£ã€‚  
  æè¿°ï¼šæ ¹æ®ä¼šè¯IDè¿”å›æ ¼å¼åŒ–åçš„æ–‡æ¡£é¢„è§ˆå†…å®¹ã€‚

- **POST /api/document-fill/start**  
  åŠŸèƒ½ï¼šå¯åŠ¨æ–‡æ¡£å¡«å†™æµç¨‹ã€‚  
  æè¿°ï¼šåˆå§‹åŒ–æ–‡æ¡£å¡«å†™ä»»åŠ¡ï¼Œè‡ªåŠ¨åˆ†ææ–‡æ¡£ç±»å‹ã€å†…å®¹å®Œæ•´æ€§ã€æ ¼å¼è§„èŒƒæ€§ç­‰ï¼Œè¿”å›ç»“æ„ä¸­åŒ…å«ï¼š
    - `detected_intent`ï¼šç³»ç»Ÿåˆ¤å®šçš„ç”¨æˆ·æ„å›¾ç±»å‹
    - `confidence`ï¼šç½®ä¿¡åº¦åˆ†æ•°
    - `recommended_action`ï¼šå»ºè®®çš„ä¸‹ä¸€æ­¥æ“ä½œ
    - `need_user_confirmation`ï¼šæ˜¯å¦éœ€è¦ç”¨æˆ·ç¡®è®¤
  è‹¥ç½®ä¿¡åº¦é«˜ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¼•å¯¼ç”¨æˆ·è¿›å…¥æ¨èæµç¨‹ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function startDocumentFill(documentContent, documentName) {
      try {
          showLoading('æ­£åœ¨åˆ†ææ–‡æ¡£ç»“æ„...');
          
          const response = await fetch('/api/document-fill/start', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                  document_content: documentContent,
                  document_name: documentName
              })
          });
          
          const result = await response.json();
          
          if (result.error) {
              throw new Error(result.error);
          }
          
          // result.response: é¦–è½®AIæé—®
          // result.current_question: å½“å‰é—®é¢˜ç¼–å·
          // result.total_questions: æ€»é—®é¢˜æ•°
          
          return result;
          
      } catch (error) {
          showMessage(`æ–‡æ¡£åˆ†æå¤±è´¥: ${error.message}`, 'error');
          return null;
      } finally {
          hideLoading();
      }
  }
  ```

- **POST /api/document-fill/respond**  
  åŠŸèƒ½ï¼šå“åº”æ–‡æ¡£å¡«å†™è¿‡ç¨‹ä¸­çš„é—®é¢˜ã€‚  
  æè¿°ï¼šæ¥æ”¶ç”¨æˆ·å¯¹å¡«å†™é—®é¢˜çš„å›ç­”ï¼Œå¹¶æ›´æ–°å¡«å†™çŠ¶æ€ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function respondToQuestion(userInput) {
      try {
          showLoading('AIæ­£åœ¨æ€è€ƒ...');
          
          const response = await fetch('/api/document-fill/respond', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                  user_input: userInput
              })
          });
          
          const result = await response.json();
          
          if (result.error) {
              throw new Error(result.error);
          }
          
          // result.response: AIå›å¤
          // result.current_question: å½“å‰é—®é¢˜ç¼–å·
          // result.total_questions: æ€»é—®é¢˜æ•°
          // result.stage: 'completed' è¡¨ç¤ºå¡«å†™å®Œæˆ
          
          if (result.stage === 'completed') {
              showMessage('æ–‡æ¡£å¡«å†™å®Œæˆï¼', 'success');
          }
          
          return result;
          
      } catch (error) {
          showMessage(`å›å¤å¤±è´¥: ${error.message}`, 'error');
          return null;
      } finally {
          hideLoading();
      }
  }
  ```

- **GET /api/document-fill/status**  
  åŠŸèƒ½ï¼šè·å–æ–‡æ¡£å¡«å†™ä»»åŠ¡çš„çŠ¶æ€ã€‚  
  æè¿°ï¼šè¿”å›å½“å‰å¡«å†™ä»»åŠ¡çš„è¿›åº¦æˆ–çŠ¶æ€ä¿¡æ¯ã€‚

- **GET /api/document-fill/result**  
  åŠŸèƒ½ï¼šè·å–æ–‡æ¡£å¡«å†™ç»“æœã€‚  
  æè¿°ï¼šè¿”å›å¡«å†™å®Œæˆçš„æ–‡æ¡£å†…å®¹æˆ–ç›¸å…³ä¿¡æ¯ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function getFillResult() {
      try {
          const response = await fetch('/api/document-fill/result');
          const result = await response.json();
          
          if (result.success) {
              // result.result.html_content: å¡«æŠ¥åHTML
              // result.result.word_content: å¡«æŠ¥åWordï¼ˆå¦‚æœ‰ï¼‰
              // result.result.fill_summary: å¡«å……æ‘˜è¦
              return result.result;
          } else {
              throw new Error(result.error || 'è·å–ç»“æœå¤±è´¥');
          }
          
      } catch (error) {
          showMessage(`è·å–ç»“æœå¤±è´¥: ${error.message}`, 'error');
          return null;
      }
  }
  ```

- **GET /api/document-fill/download**  
  åŠŸèƒ½ï¼šä¸‹è½½å¡«å†™å®Œæˆçš„æ–‡æ¡£ã€‚  
  æè¿°ï¼šæä¾›å¡«å†™åçš„æ–‡æ¡£æ–‡ä»¶ä¾›ç”¨æˆ·ä¸‹è½½ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function downloadFilledDocument() {
      try {
          const response = await fetch('/api/document-fill/download');
          
          if (response.ok) {
              const blob = await response.blob();
              const url = window.URL.createObjectURL(blob);
              const a = document.createElement('a');
              a.href = url;
              a.download = 'filled_document.html';
              document.body.appendChild(a);
              a.click();
              window.URL.revokeObjectURL(url);
              document.body.removeChild(a);
              
              showMessage('æ–‡æ¡£ä¸‹è½½æˆåŠŸï¼', 'success');
          } else {
              throw new Error('ä¸‹è½½å¤±è´¥');
          }
          
      } catch (error) {
          showMessage(`ä¸‹è½½å¤±è´¥: ${error.message}`, 'error');
      }
  }
  ```

- **POST /api/document-fill/add-material**  
  åŠŸèƒ½ï¼šæ·»åŠ è¡¥å……ææ–™åˆ°æ–‡æ¡£å¡«å†™ä»»åŠ¡ã€‚  
  æè¿°ï¼šå…è®¸ç”¨æˆ·ä¸Šä¼ é¢å¤–çš„å‚è€ƒèµ„æ–™æˆ–è¡¥å……å†…å®¹ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function addMaterial(materialName, materialContent) {
      try {
          const response = await fetch('/api/document-fill/add-material', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                  material_name: materialName,
                  material_content: materialContent
              })
          });
          
          const result = await response.json();
          
          if (result.success) {
              showMessage('è¡¥å……ææ–™æ·»åŠ æˆåŠŸï¼', 'success');
              return result;
          } else {
              throw new Error(result.error || 'æ·»åŠ å¤±è´¥');
          }
          
      } catch (error) {
          showMessage(`æ·»åŠ ææ–™å¤±è´¥: ${error.message}`, 'error');
          return null;
      }
  }
  ```

- **POST /api/document-fill/set-style**  
  åŠŸèƒ½ï¼šè®¾ç½®æ–‡æ¡£å¡«å†™ä»»åŠ¡çš„å†™ä½œé£æ ¼æ¨¡æ¿ã€‚  
  æè¿°ï¼šä¸ºå¡«å†™ä»»åŠ¡æŒ‡å®šç‰¹å®šçš„å†™ä½œé£æ ¼æˆ–æ ¼å¼è¦æ±‚ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function setWritingStyle(templateId) {
      try {
          const response = await fetch('/api/document-fill/set-style', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                  template_id: templateId
              })
          });
          
          const result = await response.json();
          
          if (result.success) {
              showMessage('å†™ä½œé£æ ¼è®¾ç½®æˆåŠŸï¼', 'success');
              return result;
          } else {
              throw new Error(result.error || 'è®¾ç½®å¤±è´¥');
          }
          
      } catch (error) {
          showMessage(`è®¾ç½®é£æ ¼å¤±è´¥: ${error.message}`, 'error');
          return null;
      }
  }
  ```

- **POST /api/table-fill**  
  åŠŸèƒ½ï¼šæ‰§è¡Œæ™ºèƒ½è¡¨æ ¼æ‰¹é‡å¡«å……æ“ä½œã€‚  
  æè¿°ï¼šå¤„ç†ä¸Šä¼ æ–‡æ¡£ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨æ ¼ï¼Œæ ¹æ®æä¾›çš„ç»“æ„åŒ–æ•°æ®æ™ºèƒ½å¡«å……è¡¨æ ¼å†…å®¹ã€‚

  **è¯·æ±‚æ ¼å¼**:
  ```json
  {
    "tables": [
      {
        "columns": ["åˆ—å1", "åˆ—å2", "åˆ—å3"],
        "data": [
          ["è¡Œ1åˆ—1", "è¡Œ1åˆ—2", "è¡Œ1åˆ—3"],
          ["è¡Œ2åˆ—1", "è¡Œ2åˆ—2", "è¡Œ2åˆ—3"]
        ]
      }
    ],
    "fill_data": [
      {"åˆ—å1": "å¡«å……å€¼1", "åˆ—å2": "å¡«å……å€¼2"},
      {"åˆ—å1": "å¡«å……å€¼3", "åˆ—å2": "å¡«å……å€¼4"}
    ]
  }
  ```

  **å“åº”æ ¼å¼**:
  ```json
  {
    "success": true,
    "filled_tables": [
      {
        "columns": ["åˆ—å1", "åˆ—å2", "åˆ—å3"],
        "data": [
          ["å¡«å……åå€¼1", "å¡«å……åå€¼2", "å¡«å……åå€¼3"],
          ["å¡«å……åå€¼4", "å¡«å……åå€¼5", "å¡«å……åå€¼6"]
        ]
      }
    ]
  }
  ```

  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹ (Fetch API)**ï¼š
  ```javascript
  async function fillTables(tables, fillData) {
      try {
          const response = await fetch('/api/table-fill', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                  tables: tables,
                  fill_data: fillData
              })
          });
          
          const result = await response.json();
          
          if (result.success) {
              console.log('è¡¨æ ¼å¡«å……æˆåŠŸ:', result.filled_tables);
              return result.filled_tables;
          } else {
              throw new Error(result.error || 'è¡¨æ ¼å¡«å……å¤±è´¥');
          }
          
      } catch (error) {
          console.error('è¡¨æ ¼å¡«å……å¤±è´¥:', error);
          throw error;
      }
  }
  
  // ä½¿ç”¨ç¤ºä¾‹
  const tables = [
      {
          columns: ['å§“å', 'å¹´é¾„', 'èŒä½'],
          data: [['å¼ ä¸‰', '', ''], ['æå››', '', '']]
      }
  ];
  
  const fillData = [
      {'å§“å': 'å¼ ä¸‰', 'å¹´é¾„': '25', 'èŒä½': 'å·¥ç¨‹å¸ˆ'},
      {'å§“å': 'æå››', 'å¹´é¾„': '30', 'èŒä½': 'ç»ç†'}
  ];
  
  const filledTables = await fillTables(tables, fillData);
  ```

  **æœ€ä½³å®è·µ**:
  1.  **æ•°æ®éªŒè¯**: åœ¨å‘é€è¯·æ±‚å‰ï¼Œå‰ç«¯åº”éªŒè¯`tables`å’Œ`fill_data`çš„æ ¼å¼ï¼Œç¡®ä¿å®ƒä»¬æ˜¯æ•°ç»„ä¸”ç»“æ„æ­£ç¡®ã€‚
  2.  **é”™è¯¯å¤„ç†**: å®ç°å®Œå–„çš„try-catchæœºåˆ¶ï¼Œå‘ç”¨æˆ·æä¾›å‹å¥½çš„é”™è¯¯æç¤ºï¼ˆå¦‚ç½‘ç»œé”™è¯¯ã€æ ¼å¼é”™è¯¯ï¼‰ã€‚
  3.  **æ€§èƒ½ä¼˜åŒ–**: å¯¹äºå¤§é‡æ•°æ®ï¼ˆå¦‚è¶…è¿‡1000è¡Œï¼‰ï¼Œå»ºè®®åˆ†æ‰¹è°ƒç”¨APIä»¥ä¿è¯æ€§èƒ½ã€‚

  **å¸¸è§é—®é¢˜ (FAQ)**:
  - **Q: å¦‚ä½•å¤„ç†ç©ºè¡¨æ ¼ï¼Ÿ**  
    A: ç©ºè¡¨æ ¼å¯ä»¥æ­£å¸¸å¤„ç†ï¼Œåªéœ€ç¡®ä¿`columns`å’Œ`data`å­—æ®µå­˜åœ¨å³å¯ï¼ˆä¾‹å¦‚ `{"columns": [], "data": []}`ï¼‰ã€‚
  - **Q: å¡«å……æ•°æ®çš„é¡ºåºé‡è¦å—ï¼Ÿ**  
    A: å¡«å……æ•°æ®æŒ‰æ•°ç»„é¡ºåºå¤„ç†ï¼Œå»ºè®®ä¿æŒä¸è¡¨æ ¼è¡Œçš„å¯¹åº”å…³ç³»ä»¥è·å¾—æœ€ä½³åŒ¹é…æ•ˆæœã€‚
  - **Q: å¦‚ä½•å¤„ç†åˆ—åä¸åŒ¹é…çš„æƒ…å†µï¼Ÿ**  
    A: ç³»ç»Ÿä¼šè‡ªåŠ¨è·³è¿‡`fill_data`ä¸­åœ¨è¡¨æ ¼`columns`é‡Œä¸å­˜åœ¨çš„åˆ—åï¼Œåªå¡«å……åŒ¹é…çš„å­—æ®µã€‚

### å†™ä½œé£æ ¼åˆ†ææ¥å£

å†™ä½œé£æ ¼åˆ†ææ¥å£ç”¨äºåˆ†ææ–‡æ¡£çš„å†™ä½œé£æ ¼ï¼Œå¹¶æ”¯æŒé£æ ¼æ¨¡æ¿çš„ä¿å­˜å’Œåº”ç”¨ã€‚è¿™äº›æ¥å£ä¸»è¦æœåŠ¡äºå†…å®¹ç”Ÿæˆå’Œé£æ ¼ä¸€è‡´æ€§éœ€æ±‚ã€‚

- **POST /api/writing-style/analyze**  
  åŠŸèƒ½ï¼šåˆ†ææ–‡æ¡£çš„å†™ä½œé£æ ¼ã€‚  
  æè¿°ï¼šå¯¹ä¸Šä¼ çš„æ–‡æ¡£è¿›è¡Œé£æ ¼åˆ†æï¼Œæå–è¯­è¨€ç‰¹å¾å’Œè¡¨è¾¾ä¹ æƒ¯ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function analyzeWritingStyle(documentContent) {
      try {
          const response = await fetch('/api/writing-style/analyze', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                  document_content: documentContent
              })
          });
          
          const result = await response.json();
          
          if (result.success) {
              console.log('é£æ ¼åˆ†æç»“æœ:', result.style_features);
              return result.style_features;
          } else {
              throw new Error(result.error || 'é£æ ¼åˆ†æå¤±è´¥');
          }
          
      } catch (error) {
          console.error('é£æ ¼åˆ†æå¤±è´¥:', error);
          return null;
      }
  }
  ```

- **GET /api/writing-style/templates**  
  åŠŸèƒ½ï¼šåˆ—å‡ºæ‰€æœ‰å†™ä½œé£æ ¼æ¨¡æ¿ã€‚  
  æè¿°ï¼šè¿”å›ç”¨æˆ·ä¿å­˜çš„æ‰€æœ‰å†™ä½œé£æ ¼æ¨¡æ¿åˆ—è¡¨ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function getStyleTemplates() {
      try {
          const response = await fetch('/api/writing-style/templates');
          const result = await response.json();
          
          if (result.success) {
              console.log('é£æ ¼æ¨¡æ¿åˆ—è¡¨:', result.templates);
              return result.templates;
          } else {
              throw new Error(result.error || 'è·å–æ¨¡æ¿å¤±è´¥');
          }
          
      } catch (error) {
          console.error('è·å–é£æ ¼æ¨¡æ¿å¤±è´¥:', error);
          return [];
      }
  }
  ```

- **POST /api/writing-style/save-template**  
  åŠŸèƒ½ï¼šä¿å­˜å†™ä½œé£æ ¼æ¨¡æ¿ã€‚  
  æè¿°ï¼šå°†åˆ†æå¾—åˆ°çš„é£æ ¼ç‰¹å¾ä¿å­˜ä¸ºå¯é‡å¤ä½¿ç”¨çš„æ¨¡æ¿ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function saveStyleTemplate(templateName, styleFeatures) {
      try {
          const response = await fetch('/api/writing-style/save-template', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                  template_name: templateName,
                  style_features: styleFeatures
              })
          });
          
          const result = await response.json();
          
          if (result.success) {
              showMessage('é£æ ¼æ¨¡æ¿ä¿å­˜æˆåŠŸï¼', 'success');
              return result.template_id;
          } else {
              throw new Error(result.error || 'ä¿å­˜å¤±è´¥');
          }
          
      } catch (error) {
          showMessage(`ä¿å­˜æ¨¡æ¿å¤±è´¥: ${error.message}`, 'error');
          return null;
      }
  }
  ```

### æ•°æ®åº“æ“ä½œæ¥å£

æ•°æ®åº“æ“ä½œæ¥å£ç”¨äºç®¡ç†åº”ç”¨æ•°æ®ï¼ŒåŒ…æ‹¬æ–‡æ¡£å†å²è®°å½•ã€ä¸ªäººæ¨¡æ¿å’Œè®¾ç½®ç­‰ã€‚è¿™äº›æ¥å£æ”¯æŒæ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨å’ŒæŸ¥è¯¢ã€‚

- **GET /api/database/stats**  
  åŠŸèƒ½ï¼šè·å–æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯ã€‚  
  æè¿°ï¼šè¿”å›æ•°æ®åº“çš„ä½¿ç”¨æƒ…å†µå’ŒåŸºæœ¬ç»Ÿè®¡æ•°æ®ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function getDatabaseStats() {
      try {
          const response = await fetch('/api/database/stats');
          const stats = await response.json();
          console.log('æ•°æ®åº“ç»Ÿè®¡:', stats);
          return stats;
      } catch (error) {
          console.error('è·å–æ•°æ®åº“ç»Ÿè®¡å¤±è´¥:', error);
          return null;
      }
  }
  ```

- **GET /api/documents/history**  
  åŠŸèƒ½ï¼šè·å–æ–‡æ¡£å¤„ç†å†å²è®°å½•ã€‚  
  æè¿°ï¼šè¿”å›ç”¨æˆ·å¤„ç†è¿‡çš„æ–‡æ¡£åˆ—è¡¨åŠå…¶å¤„ç†çŠ¶æ€ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function getDocumentHistory() {
      try {
          const response = await fetch('/api/documents/history');
          const history = await response.json();
          console.log('æ–‡æ¡£å†å²:', history);
          return history;
      } catch (error) {
          console.error('è·å–æ–‡æ¡£å†å²å¤±è´¥:', error);
          return [];
      }
  }
  ```

- **GET /api/templates/personal**  
  åŠŸèƒ½ï¼šè·å–ç”¨æˆ·çš„ä¸ªäººæ¨¡æ¿åˆ—è¡¨ã€‚  
  æè¿°ï¼šè¿”å›ç”¨æˆ·åˆ›å»ºæˆ–ä¿å­˜çš„ä¸ªäººæ¨¡æ¿é›†åˆã€‚

- **GET /api/settings**  
  åŠŸèƒ½ï¼šè·å–åº”ç”¨è®¾ç½®ã€‚  
  æè¿°ï¼šè¿”å›ç”¨æˆ·çš„åº”ç”¨è®¾ç½®æˆ–åå¥½é…ç½®ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function getSettings() {
      try {
          const response = await fetch('/api/settings');
          const settings = await response.json();
          console.log('åº”ç”¨è®¾ç½®:', settings);
          return settings;
      } catch (error) {
          console.error('è·å–è®¾ç½®å¤±è´¥:', error);
          return {};
      }
  }
  ```

- **POST /api/settings**  
  åŠŸèƒ½ï¼šæ›´æ–°åº”ç”¨è®¾ç½®ã€‚  
  æè¿°ï¼šæ¥æ”¶ç”¨æˆ·æäº¤çš„æ–°è®¾ç½®å€¼å¹¶æ›´æ–°åº”ç”¨é…ç½®ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function updateSettings(newSettings) {
      try {
          const response = await fetch('/api/settings', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify(newSettings)
          });
          
          const result = await response.json();
          
          if (result.success) {
              showMessage('è®¾ç½®æ›´æ–°æˆåŠŸï¼', 'success');
              return result;
          } else {
              throw new Error(result.error || 'æ›´æ–°å¤±è´¥');
          }
          
      } catch (error) {
          showMessage(`æ›´æ–°è®¾ç½®å¤±è´¥: ${error.message}`, 'error');
          return null;
      }
  }
  ```

### æ€§èƒ½ç›‘æ§æ¥å£

æ€§èƒ½ç›‘æ§æ¥å£ç”¨äºè·Ÿè¸ªå’Œåˆ†æåº”ç”¨çš„è¿è¡Œæ€§èƒ½ï¼Œå¸®åŠ©è¯†åˆ«ç“¶é¢ˆå’Œä¼˜åŒ–æ–¹å‘ã€‚è¿™äº›æ¥å£ä¸»è¦é¢å‘å¼€å‘å’Œè¿ç»´äººå‘˜ã€‚

- **GET /api/performance/stats**  
  åŠŸèƒ½ï¼šè·å–æ€§èƒ½ç»Ÿè®¡æ•°æ®ã€‚  
  æè¿°ï¼šè¿”å›åº”ç”¨çš„è¿è¡Œæ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚å“åº”æ—¶é—´ã€èµ„æºä½¿ç”¨ç­‰ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function getPerformanceStats() {
      try {
          const response = await fetch('/api/performance/stats');
          const stats = await response.json();
          console.log('æ€§èƒ½ç»Ÿè®¡:', stats);
          return stats;
      } catch (error) {
          console.error('è·å–æ€§èƒ½ç»Ÿè®¡å¤±è´¥:', error);
          return null;
      }
  }
  ```

- **GET /api/performance/operations**  
  åŠŸèƒ½ï¼šè·å–æ“ä½œåˆ†è§£æ•°æ®ã€‚  
  æè¿°ï¼šè¿”å›å„æ“ä½œçš„æ€§èƒ½åˆ†è§£æ•°æ®ï¼Œå¸®åŠ©å®šä½è€—æ—¶ç¯èŠ‚ã€‚

- **GET /api/performance/history**  
  åŠŸèƒ½ï¼šè·å–å†å²æ€§èƒ½æ•°æ®ã€‚  
  æè¿°ï¼šè¿”å›ä¸€æ®µæ—¶é—´å†…çš„æ€§èƒ½æŒ‡æ ‡å˜åŒ–è®°å½•ã€‚

- **POST /api/performance/export**  
  åŠŸèƒ½ï¼šå¯¼å‡ºæ€§èƒ½æ•°æ®ã€‚  
  æè¿°ï¼šå°†æ€§èƒ½æ•°æ®å¯¼å‡ºä¸ºæ–‡ä»¶æˆ–ç‰¹å®šæ ¼å¼ï¼Œä¾›è¿›ä¸€æ­¥åˆ†æã€‚

- **POST /api/test/cleanup**  
  åŠŸèƒ½ï¼šæ¸…ç†æµ‹è¯•èµ„æºï¼ˆç¬¬ä¸€é˜¶æ®µæ–°å¢ï¼‰ã€‚  
  æè¿°ï¼šæ¸…ç†æµ‹è¯•è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶ã€ç¼“å­˜æ–‡ä»¶ã€ä¸Šä¼ æ–‡ä»¶ç­‰èµ„æºã€‚
  
  **è¯·æ±‚æ ¼å¼**ï¼š
  ```json
  {
    "test_session_id": "session_123456",
    "cleanup_type": "all"
  }
  ```
  
  **å“åº”æ ¼å¼**ï¼š
  ```json
  {
    "success": true,
    "cleaned_items": {
      "temp_files": 5,
      "test_sessions": 2,
      "cache_files": 3,
      "upload_files": 1
    },
    "message": "æ¸…ç†å®Œæˆ"
  }
  ```
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function cleanupTestResources(testSessionId = null, cleanupType = 'all') {
      try {
          const response = await fetch('/api/test/cleanup', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                  test_session_id: testSessionId,
                  cleanup_type: cleanupType
              })
          });
          
          const result = await response.json();
          
          if (result.success) {
              console.log('æ¸…ç†å®Œæˆ:', result.cleaned_items);
              showMessage(`æ¸…ç†å®Œæˆï¼Œå…±æ¸…ç† ${result.cleaned_items.temp_files} ä¸ªä¸´æ—¶æ–‡ä»¶`, 'success');
              return result.cleaned_items;
          } else {
              throw new Error(result.error || 'æ¸…ç†å¤±è´¥');
          }
      } catch (error) {
          console.error('æ¸…ç†æµ‹è¯•èµ„æºå¤±è´¥:', error);
          showMessage(`æ¸…ç†å¤±è´¥: ${error.message}`, 'error');
          return null;
      }
  }
  ```

### æ‰¹é‡å¤„ç†æ¥å£

æ‰¹é‡å¤„ç†æ¥å£æ”¯æŒå¤§è§„æ¨¡æ–‡æ¡£å¤„ç†ä»»åŠ¡çš„åˆ›å»ºå’Œç®¡ç†ï¼Œé€‚ç”¨äºå¤„ç†å¤šä¸ªæ–‡æ¡£æˆ–å¤æ‚å·¥ä½œæµçš„ç”¨æˆ·éœ€æ±‚ã€‚

- **POST /api/batch/create**  
  åŠŸèƒ½ï¼šåˆ›å»ºæ‰¹é‡å¤„ç†ä»»åŠ¡ã€‚  
  æè¿°ï¼šåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„æ‰¹é‡å¤„ç†ä»»åŠ¡ï¼Œæ¥æ”¶ä»»åŠ¡å‚æ•°å’Œæ–‡ä»¶åˆ—è¡¨ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function createBatchJob(jobParams) {
      try {
          const response = await fetch('/api/batch/create', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify(jobParams)
          });
          
          const result = await response.json();
          
          if (result.success) {
              showMessage('æ‰¹é‡ä»»åŠ¡åˆ›å»ºæˆåŠŸï¼', 'success');
              return result.job_id;
          } else {
              throw new Error(result.error || 'åˆ›å»ºå¤±è´¥');
          }
          
      } catch (error) {
          showMessage(`åˆ›å»ºæ‰¹é‡ä»»åŠ¡å¤±è´¥: ${error.message}`, 'error');
          return null;
      }
  }
  ```

- **POST /api/batch/start/<job_id>**  
  åŠŸèƒ½ï¼šå¯åŠ¨æŒ‡å®šæ‰¹é‡å¤„ç†ä»»åŠ¡ã€‚  
  æè¿°ï¼šæ ¹æ®ä»»åŠ¡IDå¯åŠ¨æ‰¹é‡å¤„ç†æµç¨‹ï¼Œå¼€å§‹æ‰§è¡Œä»»åŠ¡ã€‚

- **GET /api/batch/jobs**  
  åŠŸèƒ½ï¼šè·å–æ‰€æœ‰æ‰¹é‡å¤„ç†ä»»åŠ¡åˆ—è¡¨ã€‚  
  æè¿°ï¼šè¿”å›ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ‰¹é‡ä»»åŠ¡åŠå…¶å½“å‰çŠ¶æ€ã€‚
  
  **å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
  ```javascript
  async function getBatchJobs() {
      try {
          const response = await fetch('/api/batch/jobs');
          const jobs = await response.json();
          console.log('æ‰¹é‡ä»»åŠ¡åˆ—è¡¨:', jobs);
          return jobs;
      } catch (error) {
          console.error('è·å–æ‰¹é‡ä»»åŠ¡å¤±è´¥:', error);
          return [];
      }
  }
  ```

- **GET /api/batch/job/<job_id>**  
  åŠŸèƒ½ï¼šè·å–æŒ‡å®šæ‰¹é‡å¤„ç†ä»»åŠ¡çš„çŠ¶æ€ã€‚  
  æè¿°ï¼šæ ¹æ®ä»»åŠ¡IDè¿”å›è¯¥ä»»åŠ¡çš„è¯¦ç»†ä¿¡æ¯å’Œè¿›åº¦ã€‚

- **POST /api/batch/cancel/<job_id>**  
  åŠŸèƒ½ï¼šå–æ¶ˆæŒ‡å®šæ‰¹é‡å¤„ç†ä»»åŠ¡ã€‚  
  æè¿°ï¼šæ ¹æ®ä»»åŠ¡IDç»ˆæ­¢æ­£åœ¨è¿è¡Œçš„æ‰¹é‡ä»»åŠ¡ã€‚

## ğŸ› ï¸ å‰ç«¯å¼€å‘å·¥å…·å‡½æ•°

### é€šç”¨å·¥å…·å‡½æ•°
```javascript
// æ˜¾ç¤ºåŠ è½½çŠ¶æ€
function showLoading(message = 'å¤„ç†ä¸­...') {
    const loadingEl = document.getElementById('loading');
    if (loadingEl) {
        loadingEl.textContent = message;
        loadingEl.style.display = 'block';
    }
}

// éšè—åŠ è½½çŠ¶æ€
function hideLoading() {
    const loadingEl = document.getElementById('loading');
    if (loadingEl) {
        loadingEl.style.display = 'none';
    }
}

// æ˜¾ç¤ºæ¶ˆæ¯
function showMessage(message, type = 'info') {
    const messageEl = document.getElementById('message');
    if (messageEl) {
        messageEl.textContent = message;
        messageEl.className = `message message-${type}`;
        messageEl.style.display = 'block';
        
        setTimeout(() => {
            messageEl.style.display = 'none';
        }, 3000);
    }
}

// æ–‡ä»¶å¤§å°æ ¼å¼åŒ–
function formatFileSize(bytes) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

// è¯»å–æ–‡ä»¶å†…å®¹
function readFileContent(file) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = e => resolve(e.target.result);
        reader.onerror = reject;
        reader.readAsText(file);
    });
}
```

## ğŸ“– ä½¿ç”¨æŒ‡å—ä¸æ³¨æ„äº‹é¡¹

åœ¨ä½¿ç”¨ä¸Šè¿°APIæ¥å£æ—¶ï¼Œå»ºè®®éµå¾ªä»¥ä¸‹åŸåˆ™ä»¥ç¡®ä¿é«˜æ•ˆå’Œå®‰å…¨æ“ä½œã€‚é¦–å…ˆï¼Œæ‰€æœ‰APIè°ƒç”¨åº”åŒ…å«é€‚å½“çš„èº«ä»½éªŒè¯ä¿¡æ¯ï¼Œä»¥é˜²æ­¢æœªç»æˆæƒçš„è®¿é—®ã€‚å…¶æ¬¡ï¼Œå¯¹äºæ¶‰åŠæ–‡ä»¶ä¸Šä¼ æˆ–æ•°æ®å¤„ç†çš„æ¥å£ï¼ˆå¦‚`/api/upload`ã€`/api/document-fill/start`ï¼‰ï¼Œå»ºè®®é™åˆ¶æ–‡ä»¶å¤§å°å’Œå¤„ç†æ—¶é—´ï¼Œä»¥é¿å…èµ„æºæ»¥ç”¨ã€‚

æ­¤å¤–ï¼Œå¼€å‘äººå‘˜åœ¨è°ƒç”¨APIæ—¶åº”æ³¨æ„è¯·æ±‚é¢‘ç‡æ§åˆ¶ï¼Œç‰¹åˆ«æ˜¯å¯¹äºæ€§èƒ½ç›‘æ§å’Œå¥åº·æ£€æŸ¥æ¥å£ï¼Œé¿å…å› é¢‘ç¹è°ƒç”¨å¯¼è‡´ç³»ç»Ÿè´Ÿè½½è¿‡é«˜ã€‚å¯¹äºæ‰¹é‡å¤„ç†ä»»åŠ¡ï¼Œå»ºè®®åˆç†è§„åˆ’ä»»åŠ¡è§„æ¨¡ï¼Œç¡®ä¿ä»»åŠ¡æ‰§è¡ŒæœŸé—´ç³»ç»Ÿèµ„æºå……è¶³ã€‚

### å‰ç«¯å¼€å‘æœ€ä½³å®è·µ

1. **é”™è¯¯å¤„ç†**ï¼šæ‰€æœ‰APIè°ƒç”¨éƒ½åº”åŒ…å«try-catché”™è¯¯å¤„ç†
2. **åŠ è½½çŠ¶æ€**ï¼šé•¿æ—¶é—´æ“ä½œåº”æ˜¾ç¤ºåŠ è½½çŠ¶æ€
3. **ç”¨æˆ·åé¦ˆ**ï¼šæ“ä½œç»“æœåº”åŠæ—¶åé¦ˆç»™ç”¨æˆ·
4. **å‚æ•°éªŒè¯**ï¼šå‰ç«¯åº”è¿›è¡ŒåŸºæœ¬çš„å‚æ•°éªŒè¯
5. **æ–‡ä»¶å¤„ç†**ï¼šæ–‡ä»¶ä¸Šä¼ å‰åº”æ£€æŸ¥æ ¼å¼å’Œå¤§å°

### æ¥å£è°ƒç”¨æµç¨‹ç¤ºä¾‹

```javascript
// å®Œæ•´çš„æ–‡æ¡£å¤„ç†æµç¨‹ç¤ºä¾‹
async function processDocument(file) {
    try {
        // 1. ä¸Šä¼ æ–‡ä»¶
        const uploadResult = await uploadFile(file);
        if (!uploadResult) return;
        
        // 2. è¯»å–æ–‡ä»¶å†…å®¹
        const content = await readFileContent(file);
        
        // 3. å¯åŠ¨æ–‡æ¡£å¡«å†™
        const fillSession = await startDocumentFill(content, file.name);
        if (!fillSession) return;
        
        // 4. æ˜¾ç¤ºé¦–è½®é—®é¢˜
        displayQuestion(fillSession.response);
        
        // 5. è®¾ç½®é—®é¢˜å›ç­”å¤„ç†
        setupQuestionResponse();
        
    } catch (error) {
        showMessage(`å¤„ç†å¤±è´¥: ${error.message}`, 'error');
    }
}
```

å¦‚éœ€æ›´è¯¦ç»†çš„å‚æ•°è¯´æ˜æˆ–ç¤ºä¾‹ä»£ç ï¼Œå¯å‚è€ƒé¡¹ç›®ä»£ç åº“ä¸­çš„æµ‹è¯•æ–‡ä»¶ï¼ˆå¦‚`test_api_comprehensive.py`ï¼‰æˆ–ç›¸å…³æ–‡æ¡£ã€‚æœªæ¥ç‰ˆæœ¬çš„æ¥å£æ–‡æ¡£å°†è¿›ä¸€æ­¥è¡¥å……è¯·æ±‚å’Œå“åº”ç¤ºä¾‹ï¼Œä»¥ä¾¿äºå¼€å‘äººå‘˜å¿«é€Ÿä¸Šæ‰‹ã€‚

## ğŸ“‹ ç»“è®º

æœ¬åç«¯æ¥å£å¼€å‘æ–‡æ¡£æ¢³ç†äº†Office-Doc-Agenté¡¹ç›®ä¸­å·²å®ç°çš„45ä¸ªAPIç«¯ç‚¹ï¼Œè¦†ç›–äº†ä»é¡µé¢è®¿é—®åˆ°å¤æ‚æ–‡æ¡£å¤„ç†çš„å…¨æ–¹ä½åŠŸèƒ½ã€‚é€šè¿‡å¯¹APIè¿›è¡Œæ¨¡å—åŒ–åˆ†ç±»ï¼Œæœ¬æ–‡æ¡£ä¸ºå¼€å‘äººå‘˜æä¾›äº†æ¸…æ™°çš„æ¥å£å‚è€ƒï¼Œæœ‰åŠ©äºæ¥å£è°ƒç”¨ã€æµ‹è¯•éªŒè¯åŠåç»­åŠŸèƒ½æ‰©å±•ã€‚

**æœ¬æ–‡æ¡£åŒæ—¶åŒ…å«åç«¯æ¥å£å®šä¹‰å’Œå‰ç«¯è°ƒç”¨ç¤ºä¾‹ï¼Œç¡®ä¿å‰åç«¯å¼€å‘çš„ä¸€è‡´æ€§ã€‚**

åœ¨æœªæ¥çš„å¼€å‘å·¥ä½œä¸­ï¼Œå»ºè®®å›¢é˜ŸæŒç»­æ›´æ–°æ¥å£æ–‡æ¡£ï¼Œç¡®ä¿å…¶ä¸ä»£ç å®ç°ä¿æŒåŒæ­¥ã€‚åŒæ—¶ï¼Œé’ˆå¯¹éƒ¨åˆ†é«˜é¢‘ä½¿ç”¨æ¥å£ï¼ˆå¦‚æ–‡æ¡£ä¸Šä¼ å’Œå¡«å†™æ¥å£ï¼‰ï¼Œå¯è€ƒè™‘å¼€å‘æ›´è¯¦ç»†çš„ä½¿ç”¨æ•™ç¨‹æˆ–SDKï¼Œä»¥æå‡å¼€å‘æ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚

## ğŸ”® è¡¥å……APIè®¾è®¡å»ºè®®

ä»¥ä¸‹APIè®¾è®¡å»ºè®®åŸºäºå‰ç«¯è®¾è®¡å’Œç°æœ‰åç«¯APIçš„å…¨é¢åˆ†æï¼Œå¡«è¡¥äº†å½“å‰å®ç°ä¸å‰ç«¯éœ€æ±‚ä¹‹é—´çš„å·®è·ã€‚è¿™äº›å»ºè®®éµå¾ªRESTful APIè®¾è®¡çš„æœ€ä½³å®è·µï¼Œä¸ç°æœ‰`web_app.py`æ–‡ä»¶ç»“æ„ä¿æŒä¸€è‡´ã€‚

### 1. æ–‡é£ç»Ÿä¸€é¢„è§ˆä¸æ¥å—/æ‹’ç»

**ç›®çš„**ï¼šå…è®¸ç”¨æˆ·é¢„è§ˆåº”ç”¨äºæ–‡æ¡£çš„æ–‡é£å˜åŒ–ï¼Œå¹¶é€ä¸ªæˆ–æ‰¹é‡æ¥å—æˆ–æ‹’ç»è¿™äº›å˜åŒ–ã€‚

#### é¢„è§ˆæ–‡é£å˜åŒ–
- **ç«¯ç‚¹**ï¼š`/api/style-alignment/preview`
- **æ–¹æ³•**ï¼š`POST`
- **å‚æ•°**ï¼š
  - `document_content` (string)ï¼šè¦åº”ç”¨æ–‡é£å˜åŒ–çš„æ–‡æ¡£å†…å®¹
  - `document_name` (string)ï¼šæ–‡æ¡£åç§°
  - `style_template_id` (string)ï¼šè¦åº”ç”¨çš„æ–‡é£æ¨¡æ¿ID
- **å“åº”**ï¼š
  - `success` (boolean)ï¼šæŒ‡ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸ
  - `preview_data` (object)ï¼šåŒ…å«å¸¦æœ‰é«˜äº®å˜åŒ–å’Œå»ºè®®çš„åŸå§‹å†…å®¹
    - `original_content` (string)ï¼šåŸå§‹æ–‡æ¡£å†…å®¹
    - `suggested_changes` (array)ï¼šåŒ…å«IDã€åŸå§‹æ–‡æœ¬ã€å»ºè®®æ–‡æœ¬å’Œç®€è¦ä¿®æ”¹åŸå› çš„å˜åŒ–åˆ—è¡¨
  - `session_id` (string)ï¼šç”¨äºåç»­æ“ä½œçš„é¢„è§ˆä¼šè¯çš„å”¯ä¸€æ ‡è¯†ç¬¦

**å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
```javascript
async function previewStyleChanges(documentContent, documentName, styleTemplateId) {
    try {
        showLoading('æ­£åœ¨ç”Ÿæˆæ–‡é£é¢„è§ˆ...');
        
        const response = await fetch('/api/style-alignment/preview', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                document_content: documentContent,
                document_name: documentName,
                style_template_id: styleTemplateId
            })
        });
        
        const result = await response.json();
        
        if (result.success) {
            displayStylePreview(result.preview_data);
            return result.session_id;
        } else {
            throw new Error(result.error || 'é¢„è§ˆç”Ÿæˆå¤±è´¥');
        }
        
    } catch (error) {
        showMessage(`é¢„è§ˆå¤±è´¥: ${error.message}`, 'error');
        return null;
    } finally {
        hideLoading();
    }
}
```

#### æ¥å—/æ‹’ç»å•ä¸ªå˜åŒ–
- **ç«¯ç‚¹**ï¼š`/api/style-alignment/changes/<session_id>/<change_id>`
- **æ–¹æ³•**ï¼š`PATCH`
- **å‚æ•°**ï¼š
  - `action` (string)ï¼šæŒ‡ç¤ºå¯¹ç‰¹å®šå˜åŒ–çš„æ“ä½œï¼Œå€¼ä¸º"accept"æˆ–"reject"
- **å“åº”**ï¼š
  - `success` (boolean)ï¼šæŒ‡ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸ
  - `change_id` (string)ï¼šè¢«æ“ä½œçš„å˜åŒ–ID
  - `action` (string)ï¼šæ‰§è¡Œçš„æ“ä½œï¼ˆ"accept"æˆ–"reject"ï¼‰
  - `updated_preview` (object)ï¼šå¯é€‰åœ°è¿”å›æ“ä½œåçš„æ›´æ–°é¢„è§ˆ

#### æ¥å—/æ‹’ç»æ‰€æœ‰å˜åŒ–
- **ç«¯ç‚¹**ï¼š`/api/style-alignment/changes/<session_id>/batch`
- **æ–¹æ³•**ï¼š`PATCH`
- **å‚æ•°**ï¼š
  - `action` (string)ï¼šå¯¹æ‰€æœ‰å˜åŒ–åº”ç”¨çš„æ“ä½œï¼Œå€¼ä¸º"accept_all"æˆ–"reject_all"
- **å“åº”**ï¼š
  - `success` (boolean)ï¼šæŒ‡ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸ
  - `action` (string)ï¼šæ‰§è¡Œçš„æ‰¹é‡æ“ä½œ
  - `change_count` (integer)ï¼šå—æ“ä½œå½±å“çš„å˜åŒ–æ•°é‡

#### å¯¼å‡ºæ–‡é£è°ƒæ•´åçš„æ–‡æ¡£
- **ç«¯ç‚¹**ï¼š`/api/style-alignment/export/<session_id>`
- **æ–¹æ³•**ï¼š`GET`
- **å“åº”**ï¼šè¿”å›åº”ç”¨äº†æ‰€æœ‰æ¥å—çš„æ–‡é£å˜åŒ–çš„æ–‡æ¡£ä½œä¸ºå¯ä¸‹è½½çš„DOCXæ–‡ä»¶

### 2. æ™ºèƒ½å¡«æŠ¥çš„è‡ªåŠ¨åŒ¹é…æ•°æ®

**ç›®çš„**ï¼šåœ¨å¡«æŠ¥è¿‡ç¨‹ä¸­å¯ç”¨æ•°æ®åˆ°æ–‡æ¡£æ¨¡æ¿å­—æ®µçš„è‡ªåŠ¨åŒ¹é…ã€‚

#### è‡ªåŠ¨åŒ¹é…æ•°æ®
- **ç«¯ç‚¹**ï¼š`/api/document-fill/auto-match`
- **æ–¹æ³•**ï¼š`POST`
- **å‚æ•°**ï¼š
  - `session_id` (string)ï¼šæ´»åŠ¨æ–‡æ¡£å¡«æŠ¥ä¼šè¯çš„ID
  - `data_sources` (array)ï¼šè¦ä¸æ–‡æ¡£å­—æ®µåŒ¹é…çš„æ•°æ®æºåˆ—è¡¨ï¼ˆæ–‡æœ¬æˆ–æ–‡ä»¶å¼•ç”¨ï¼‰
- **å“åº”**ï¼š
  - `success` (boolean)ï¼šæŒ‡ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸ
  - `matched_fields` (object)ï¼šåŒ…å«å­—æ®µIDæ˜ å°„åˆ°åŒ¹é…æ•°æ®å€¼çš„å¯¹è±¡
  - `unmatched_fields` (array)ï¼šæ— æ³•è‡ªåŠ¨åŒ¹é…çš„å­—æ®µIDåˆ—è¡¨
  - `confidence_scores` (object)ï¼šæ¯ä¸ªåŒ¹é…å­—æ®µçš„ç½®ä¿¡åº¦åˆ†æ•°
  - `conflicts` (array)ï¼šå¤šä¸ªæ•°æ®æºä¸ºåŒä¸€å­—æ®µæä¾›å€¼æ—¶çš„å†²çªåˆ—è¡¨

**å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
```javascript
async function autoMatchData(sessionId, dataSources) {
    try {
        showLoading('æ­£åœ¨è‡ªåŠ¨åŒ¹é…æ•°æ®...');
        
        const response = await fetch('/api/document-fill/auto-match', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                session_id: sessionId,
                data_sources: dataSources
            })
        });
        
        const result = await response.json();
        
        if (result.success) {
            displayMatchedFields(result.matched_fields);
            if (result.conflicts.length > 0) {
                displayConflicts(result.conflicts);
            }
            return result;
        } else {
            throw new Error(result.error || 'è‡ªåŠ¨åŒ¹é…å¤±è´¥');
        }
        
    } catch (error) {
        showMessage(`è‡ªåŠ¨åŒ¹é…å¤±è´¥: ${error.message}`, 'error');
        return null;
    } finally {
        hideLoading();
    }
}
```

#### è§£å†³å†²çª
- **ç«¯ç‚¹**ï¼š`/api/document-fill/auto-match/conflicts/<session_id>`
- **æ–¹æ³•**ï¼š`PATCH`
- **å‚æ•°**ï¼š
  - `resolutions` (object)ï¼šç”¨æˆ·è§£å†³å†²çªçš„é€‰æ‹©ï¼Œå°†å­—æ®µIDæ˜ å°„åˆ°æ‰€é€‰å€¼
- **å“åº”**ï¼š
  - `success` (boolean)ï¼šæŒ‡ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸ
  - `resolved_fields` (object)ï¼šè§£å†³å†²çªçš„å­—æ®µåŠå…¶æœ€ç»ˆå€¼

### 3. æ–‡æ¡£å®¡é˜…

**ç›®çš„**ï¼šæ”¯æŒå®Œæ•´çš„æ–‡æ¡£å®¡é˜…è¿‡ç¨‹ï¼ŒåŒ…æ‹¬å‘èµ·å®¡é˜…ã€è·å–å»ºè®®ã€æ¥å—/æ‹’ç»å»ºè®®ä»¥åŠå¯¼å‡ºå®¡é˜…åçš„æ–‡æ¡£ã€‚

#### å¼€å§‹å®¡é˜…
- **ç«¯ç‚¹**ï¼š`/api/document-review/start`
- **æ–¹æ³•**ï¼š`POST`
- **å‚æ•°**ï¼š
  - `document_content` (string)ï¼šè¦å®¡é˜…çš„æ–‡æ¡£å†…å®¹
  - `document_name` (string)ï¼šæ–‡æ¡£åç§°
  - `review_focus` (string)ï¼šå®¡é˜…çš„é‡ç‚¹ï¼ˆä¾‹å¦‚ï¼Œ"academic"ã€"business"ã€"auto"ï¼‰
- **å“åº”**ï¼š
  - `success` (boolean)ï¼šæŒ‡ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸ
  - `review_session_id` (string)ï¼šå®¡é˜…ä¼šè¯çš„å”¯ä¸€æ ‡è¯†ç¬¦
  - `status` (string)ï¼šå®¡é˜…è¿‡ç¨‹çš„åˆå§‹çŠ¶æ€

**å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
```javascript
async function startDocumentReview(documentContent, documentName, reviewFocus) {
    try {
        showLoading('æ­£åœ¨å¯åŠ¨æ–‡æ¡£å®¡é˜…...');
        
        const response = await fetch('/api/document-review/start', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                document_content: documentContent,
                document_name: documentName,
                review_focus: reviewFocus
            })
        });
        
        const result = await response.json();
        
        if (result.success) {
            showMessage('æ–‡æ¡£å®¡é˜…å·²å¯åŠ¨', 'success');
            return result.review_session_id;
        } else {
            throw new Error(result.error || 'å®¡é˜…å¯åŠ¨å¤±è´¥');
        }
        
    } catch (error) {
        showMessage(`å®¡é˜…å¯åŠ¨å¤±è´¥: ${error.message}`, 'error');
        return null;
    } finally {
        hideLoading();
    }
}
```

#### è·å–å®¡é˜…å»ºè®®
- **ç«¯ç‚¹**ï¼š`/api/document-review/suggestions/<review_session_id>`
- **æ–¹æ³•**ï¼š`GET`
- **å“åº”**ï¼š
  - `success` (boolean)ï¼šæŒ‡ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸ
  - `suggestions` (array)ï¼šæŒ‰ä¼˜å…ˆçº§æ’åºçš„å®¡é˜…å»ºè®®åˆ—è¡¨

#### æ¥å—/æ‹’ç»å»ºè®®
- **ç«¯ç‚¹**ï¼š`/api/document-review/suggestions/<review_session_id>/<suggestion_id>`
- **æ–¹æ³•**ï¼š`PATCH`
- **å‚æ•°**ï¼š
  - `action` (string)ï¼šæŒ‡ç¤ºå¯¹ç‰¹å®šå»ºè®®çš„æ“ä½œï¼Œå€¼ä¸º"accept"æˆ–"reject"

#### æ¥å—/æ‹’ç»æ‰€æœ‰å»ºè®®
- **ç«¯ç‚¹**ï¼š`/api/document-review/suggestions/<review_session_id>/batch`
- **æ–¹æ³•**ï¼š`PATCH`
- **å‚æ•°**ï¼š
  - `action` (string)ï¼šå¯¹æ‰€æœ‰å»ºè®®åº”ç”¨çš„æ“ä½œï¼Œå€¼ä¸º"accept_all"æˆ–"reject_all"

#### å¯¼å‡ºå®¡é˜…åçš„æ–‡æ¡£
- **ç«¯ç‚¹**ï¼š`/api/document-review/export/<review_session_id>`
- **æ–¹æ³•**ï¼š`GET`
- **å“åº”**ï¼šè¿”å›åº”ç”¨äº†æ¥å—çš„å»ºè®®çš„å®¡é˜…æ–‡æ¡£ä½œä¸ºå¯ä¸‹è½½çš„DOCXæ–‡ä»¶

### 4. æ¨¡æ¿ç®¡ç†ï¼ˆæ ¼å¼å’Œæ–‡é£ï¼‰

**ç›®çš„**ï¼šå®ç°æ ¼å¼å’Œæ–‡é£æ¨¡æ¿çš„å…¨é¢ç®¡ç†ï¼ŒåŒ…æ‹¬é‡å‘½åå’Œåˆ é™¤ã€‚

#### é‡å‘½åæ¨¡æ¿
- **ç«¯ç‚¹**ï¼š`/api/templates/<template_type>/<template_id>/rename`
- **æ–¹æ³•**ï¼š`PATCH`
- **å‚æ•°**ï¼š
  - `template_type` (string)ï¼šæŒ‡å®šæ¨¡æ¿ç±»å‹ï¼Œå€¼ä¸º"format"æˆ–"style"
  - `new_name` (string)ï¼šæ¨¡æ¿çš„æ–°åç§°
- **å“åº”**ï¼š
  - `success` (boolean)ï¼šæŒ‡ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸ
  - `template_id` (string)ï¼šé‡å‘½åçš„æ¨¡æ¿ID
  - `new_name` (string)ï¼šæ¨¡æ¿æ›´æ–°åçš„åç§°

#### åˆ é™¤æ¨¡æ¿ç¡®è®¤
- **ç«¯ç‚¹**ï¼š`/api/templates/<template_type>/<template_id>/confirm-delete`
- **æ–¹æ³•**ï¼š`GET`
- **å“åº”**ï¼š
  - `success` (boolean)ï¼šæŒ‡ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸ
  - `confirmation_message` (string)ï¼šæé†’ç”¨æˆ·åˆ é™¤åæœçš„æ¶ˆæ¯
  - `confirmation_token` (string)ï¼šå®Œæˆåˆ é™¤æ‰€éœ€çš„ä¸´æ—¶ä»¤ç‰Œ

#### ç¡®è®¤åˆ é™¤æ¨¡æ¿
- **ç«¯ç‚¹**ï¼š`/api/templates/<template_type>/<template_id>`
- **æ–¹æ³•**ï¼š`DELETE`
- **å‚æ•°**ï¼š
  - `confirmation_token` (string)ï¼šä»ç¡®è®¤æ­¥éª¤æ”¶åˆ°çš„ä»¤ç‰Œï¼Œç”¨äºéªŒè¯åˆ é™¤
- **å“åº”**ï¼š
  - `success` (boolean)ï¼šæŒ‡ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸ
  - `template_id` (string)ï¼šåˆ é™¤çš„æ¨¡æ¿ID

### 5. ä»å†å²è®°å½•ä¸­é‡æ–°åº”ç”¨æ“ä½œ

**ç›®çš„**ï¼šå…è®¸ç”¨æˆ·ä»æ–‡æ¡£å¤„ç†å†å²è®°å½•ä¸­é‡æ–°åº”ç”¨ç‰¹å®šæ“ä½œã€‚

#### é‡æ–°åº”ç”¨æ“ä½œ
- **ç«¯ç‚¹**ï¼š`/api/documents/history/<record_id>/reapply`
- **æ–¹æ³•**ï¼š`POST`
- **å‚æ•°**ï¼š
  - `record_id` (string)ï¼šè¦é‡æ–°åº”ç”¨çš„å†å²è®°å½•ID
- **å“åº”**ï¼š
  - `success` (boolean)ï¼šæŒ‡ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸ
  - `new_record_id` (string)ï¼šé€šè¿‡é‡æ–°åº”ç”¨æ“ä½œåˆ›å»ºçš„æ–°å¤„ç†è®°å½•ID
  - `status` (string)ï¼šé‡æ–°åº”ç”¨è¿‡ç¨‹çš„çŠ¶æ€
  - `message` (string, å¯é€‰)ï¼šå¦‚æœåŸå§‹æ–‡ä»¶ç¼ºå¤±ï¼Œåˆ™æ˜¾ç¤ºç›¸åº”æ¶ˆæ¯

#### ä¸ºé‡æ–°åº”ç”¨ä¸Šä¼ æ–‡ä»¶
- **ç«¯ç‚¹**ï¼š`/api/documents/history/<record_id>/upload`
- **æ–¹æ³•**ï¼š`POST`
- **å‚æ•°**ï¼š
  - `record_id` (string)ï¼šè¦ä¸ºå…¶ä¸Šä¼ æ–‡ä»¶çš„å†å²è®°å½•ID
  - `file` (file)ï¼šä½œä¸ºç¼ºå¤±åŸå§‹æ–‡ä»¶æ›¿ä»£å“ä¸Šä¼ çš„æ–‡ä»¶
- **å“åº”**ï¼š
  - `success` (boolean)ï¼šæŒ‡ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸ
  - `file_path` (string)ï¼šä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„
  - `message` (string)ï¼šç¡®è®¤æ¶ˆæ¯

**å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
```javascript
async function reapplyHistoryOperation(recordId) {
    try {
        showLoading('æ­£åœ¨é‡æ–°åº”ç”¨æ“ä½œ...');
        
        const response = await fetch(`/api/documents/history/${recordId}/reapply`, {
            method: 'POST'
        });
        
        const result = await response.json();
        
        if (result.success) {
            showMessage('æ“ä½œé‡æ–°åº”ç”¨æˆåŠŸ', 'success');
            return result.new_record_id;
        } else {
            if (result.message && result.message.includes('æ–‡ä»¶ç¼ºå¤±')) {
                showMessage('åŸå§‹æ–‡ä»¶ç¼ºå¤±ï¼Œè¯·é‡æ–°ä¸Šä¼ ', 'warning');
                return null;
            }
            throw new Error(result.error || 'é‡æ–°åº”ç”¨å¤±è´¥');
        }
        
    } catch (error) {
        showMessage(`é‡æ–°åº”ç”¨å¤±è´¥: ${error.message}`, 'error');
        return null;
    } finally {
        hideLoading();
    }
}
```

## ğŸ“‹ ç»“è®º

æœ¬åç«¯æ¥å£å¼€å‘æ–‡æ¡£æ¢³ç†äº†Office-Doc-Agenté¡¹ç›®ä¸­å·²å®ç°çš„45ä¸ªAPIç«¯ç‚¹ï¼Œè¦†ç›–äº†ä»é¡µé¢è®¿é—®åˆ°å¤æ‚æ–‡æ¡£å¤„ç†çš„å…¨æ–¹ä½åŠŸèƒ½ã€‚é€šè¿‡å¯¹APIè¿›è¡Œæ¨¡å—åŒ–åˆ†ç±»ï¼Œæœ¬æ–‡æ¡£ä¸ºå¼€å‘äººå‘˜æä¾›äº†æ¸…æ™°çš„æ¥å£å‚è€ƒï¼Œæœ‰åŠ©äºæ¥å£è°ƒç”¨ã€æµ‹è¯•éªŒè¯åŠåç»­åŠŸèƒ½æ‰©å±•ã€‚

**æœ¬æ–‡æ¡£åŒæ—¶åŒ…å«åç«¯æ¥å£å®šä¹‰å’Œå‰ç«¯è°ƒç”¨ç¤ºä¾‹ï¼Œç¡®ä¿å‰åç«¯å¼€å‘çš„ä¸€è‡´æ€§ã€‚**

åœ¨æœªæ¥çš„å¼€å‘å·¥ä½œä¸­ï¼Œå»ºè®®å›¢é˜ŸæŒç»­æ›´æ–°æ¥å£æ–‡æ¡£ï¼Œç¡®ä¿å…¶ä¸ä»£ç å®ç°ä¿æŒåŒæ­¥ã€‚åŒæ—¶ï¼Œé’ˆå¯¹éƒ¨åˆ†é«˜é¢‘ä½¿ç”¨æ¥å£ï¼ˆå¦‚æ–‡æ¡£ä¸Šä¼ å’Œå¡«å†™æ¥å£ï¼‰ï¼Œå¯è€ƒè™‘å¼€å‘æ›´è¯¦ç»†çš„ä½¿ç”¨æ•™ç¨‹æˆ–SDKï¼Œä»¥æå‡å¼€å‘æ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚

---
**æ–‡æ¡£äºº**: AI Assistant (Claude)  
**æ–‡æ¡£æ—¶é—´**: 2025å¹´6æœˆ26æ—¥  
**ç‰ˆæœ¬**: v3.0  
**çŠ¶æ€æ£€æµ‹**: å·²å®Œæˆ (2025-06-26 10:15:00)  
**å®¡æ ¸çŠ¶æ€**: å¾…å®¡æ ¸
