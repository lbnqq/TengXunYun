# 后端接口开发文档 (2025年6月26日)

## 📋 文档概述

本文档旨在系统梳理 Office-Doc-Agent 项目中已实现的所有后端API接口，为开发人员、测试人员及相关团队成员提供清晰的接口参考。本文档基于项目代码库中的实际实现，涵盖了API端点的功能、请求方法、路径、参数及主要用途，旨在方便接口调用、测试验证及后续维护工作。

本接口文档按照功能模块对API进行分类整理，包括文档处理、写作风格分析、数据库操作、性能监控、批量处理等主要模块。每个模块下详细列出相关API端点，并提供简要描述以帮助理解其作用。文档内容基于2025年6月26日的代码状态生成，未来如有接口变更，将更新相应版本。

## 📅 文档信息

本接口文档的生成时间为2025年6月26日，基于项目代码库中截至该日期的最新实现。API信息通过对`src/web_app.py`及相关文件的分析提取，确保内容的准确性和完整性。本文档遵循《项目开发规范》(v1.0, 2025年6月25日制定)中对技术文档结构和内容的要求，旨在为项目团队提供可靠的参考资料。

在梳理API接口的过程中，共识别出45个端点，覆盖了从基本健康检查到复杂文档处理的全方位功能。以下章节将按功能模块逐一展开详细说明，以便于开发人员快速定位所需接口。

## 🏗️ API分类与详细说明

API接口按照功能模块进行分类，以便于理解和使用。每个模块包含若干相关端点，涵盖了从基本页面访问到复杂业务逻辑处理的不同场景。以下是各模块的详细描述及接口清单。

### 页面访问接口

页面访问接口主要用于前端页面的渲染和访问，属于基础路由功能。这些接口通常不涉及复杂业务逻辑，主要负责页面内容的返回。

- **GET /**  
  功能：返回主页面内容，通常是项目的入口页面。  
  描述：这是用户访问应用时的默认页面，可能包含基本的导航和功能介绍。

- **GET /demo**  
  功能：返回演示页面。  
  描述：用于展示项目的基本功能或提供演示内容，适合新用户了解应用特性。

- **GET /dashboard**  
  功能：返回仪表盘页面。  
  描述：仪表盘页面通常用于展示项目运行状态、统计数据或关键指标。

- **GET /batch**  
  功能：返回批量处理页面。  
  描述：提供批量任务创建和管理的前端界面。

- **GET /debug_frontend.html**  
  功能：返回调试前端页面。  
  描述：用于开发和调试前端功能，可能包含测试工具或调试信息。

- **GET /test_ai_features.html**  
  功能：返回AI功能测试页面。  
  描述：专门用于测试AI相关功能的页面，可能包含交互式测试工具。

- **GET /examples/<filename>**  
  功能：下载示例文件。  
  描述：根据提供的文件名返回对应的示例文件，适用于用户获取模板或参考资料。

### 健康检查与配置接口

健康检查与配置接口用于监控应用状态和获取配置信息，确保系统正常运行。这些接口通常用于运维和调试。

- **GET /api/health**  
  功能：返回应用健康状态。  
  描述：用于检查应用是否正常运行，通常返回简单的状态信息。

- **GET /api/config**  
  功能：获取应用配置信息。  
  描述：返回当前应用的配置参数，可能包括功能开关或环境变量。

- **GET /api/models**  
  功能：获取可用模型列表。  
  描述：返回应用支持的AI模型或处理模型列表，供用户选择或配置。

### 文档处理接口

文档处理接口是应用的核心功能模块，涵盖了文档上传、格式对齐、模板应用及文档填写等功能。这些接口支持复杂的业务逻辑处理。

- **POST /api/upload**  
  功能：上传文件。  
  描述：接收用户上传的文档文件，并进行初步处理或存储。

- **POST /api/format-alignment**  
  功能：执行格式对齐操作。  
  描述：根据指定规则或模板对上传的文档进行格式调整。

- **GET /api/format-templates**  
  功能：列出所有格式模板。  
  描述：返回可用的格式模板列表，供用户选择。

- **GET /api/format-templates/<template_id>**  
  功能：获取指定格式模板的详细信息。  
  描述：根据模板ID返回该模板的具体内容和配置。

- **POST /api/format-templates/<template_id>/apply**  
  功能：应用指定格式模板到文档。  
  描述：将选定的模板应用到目标文档上，执行格式化操作。

- **GET /api/format-alignment/preview/<session_id>**  
  功能：预览格式化后的文档。  
  描述：根据会话ID返回格式化后的文档预览内容。

- **POST /api/document-fill/start**  
  功能：启动文档填写流程。  
  描述：初始化文档填写任务，可能包括解析文档结构和生成填写问题。

- **POST /api/document-fill/respond**  
  功能：响应文档填写过程中的问题。  
  描述：接收用户对填写问题的回答，并更新填写状态。

- **GET /api/document-fill/status**  
  功能：获取文档填写任务的状态。  
  描述：返回当前填写任务的进度或状态信息。

- **GET /api/document-fill/result**  
  功能：获取文档填写结果。  
  描述：返回填写完成的文档内容或相关信息。

- **GET /api/document-fill/download**  
  功能：下载填写完成的文档。  
  描述：提供填写后的文档文件供用户下载。

- **POST /api/document-fill/add-material**  
  功能：添加补充材料到文档填写任务。  
  描述：允许用户上传额外的参考资料或补充内容。

- **POST /api/document-fill/set-style**  
  功能：设置文档填写任务的写作风格模板。  
  描述：为填写任务指定特定的写作风格或格式要求。

- **POST /api/table-fill**  
  功能：执行表格填写操作mechanism.  
  描述：处理上传文档中的表格内容，自动识别并填写表格数据。

### 写作风格分析接口

写作风格分析接口用于分析文档的写作风格，并支持风格模板的保存和应用。这些接口主要服务于内容生成和风格一致性需求。

- **POST /api/writing-style/analyze**  
  功能：分析文档的写作风格。  
  描述：对上传的文档进行风格分析，提取语言特征和表达习惯。

- **POST /api/writing-style/save-template**  
  功能：保存写作风格模板。  
  描述：将分析得到的风格特征保存为可重复使用的模板。

- **GET /api/writing-style/templates**  
  功能：列出所有写作风格模板。  
  描述：返回用户保存的所有写作风格模板列表。

- **GET /api/writing-style/templates/<template_id>**  
  功能：获取指定写作风格模板的详细信息。  
  描述：根据模板ID返回该模板的具体风格参数和描述。

### 数据库操作接口

数据库操作接口用于管理应用数据，包括文档历史记录、个人模板和设置等。这些接口支持数据的持久化存储和查询。

- **GET /api/database/stats**  
  功能：获取数据库统计信息。  
  描述：返回数据库的使用情况和基本统计数据。

- **GET /api/documents/history**  
  功能：获取文档处理历史记录。  
  描述：返回用户处理过的文档列表及其处理状态。

- **GET /api/templates/personal**  
  功能：获取用户的个人模板列表。  
  描述：返回用户创建或保存的个人模板集合。

- **GET /api/settings**  
  功能：获取应用设置。  
  描述：返回用户的应用设置或偏好配置。

- **POST /api/settings**  
  功能：更新应用设置。  
  描述：接收用户提交的新设置值并更新应用配置。

### 性能监控接口

性能监控接口用于跟踪和分析应用的运行性能，帮助识别瓶颈和优化方向。这些接口主要面向开发和运维人员。

- **GET /api/performance/stats**  
  功能：获取性能统计数据。  
  描述：返回应用的运行性能指标，如响应时间、资源使用等。

- **GET /api/performance/health**  
  功能：获取API健康状态。  
  描述：检查API服务的健康状况，返回详细的运行状态信息。

- **GET /api/performance/operations**  
  功能：获取操作分解数据。  
  描述：返回各操作的性能分解数据，帮助定位耗时环节。

- **GET /api/performance/history**  
  功能：获取历史性能数据。  
  描述：返回一段时间内的性能指标变化记录。

- **POST /api/performance/export**  
  功能：导出性能数据。  
  描述：将性能数据导出为文件或特定格式，供进一步分析。

### 批量处理接口

批量处理接口支持大规模文档处理任务的创建和管理，适用于处理多个文档或复杂工作流的用户需求。

- **POST /api/batch/create**  
  功能：创建批量处理任务。  
  描述：初始化一个新的批量处理任务，接收任务参数和文件列表。

- **POST /api/batch/start/<job_id>**  
  功能：启动指定批量处理任务。  
  描述：根据任务ID启动批量处理流程，开始执行任务。

- **GET /api/batch/jobs**  
  功能：获取所有批量处理任务列表。  
  描述：返回用户创建的所有批量任务及其当前状态。

- **GET /api/batch/job/<job_id>**  
  功能：获取指定批量处理任务的状态。  
  描述：根据任务ID返回该任务的详细信息和进度。

- **POST /api/batch/cancel/<job_id>**  
  功能：取消指定批量处理任务。  
  描述：根据任务ID终止正在运行的批量任务。

## 📖 使用指南与注意事项

在使用上述API接口时，建议遵循以下原则以确保高效和安全操作。首先，所有API调用应包含适当的身份验证信息，以防止未经授权的访问。其次，对于涉及文件上传或数据处理的接口（如`/api/upload`、`/api/document-fill/start`），建议限制文件大小和处理时间，以避免资源滥用。

此外，开发人员在调用API时应注意请求频率控制，特别是对于性能监控和健康检查接口，避免因频繁调用导致系统负载过高。对于批量处理任务，建议合理规划任务规模，确保任务执行期间系统资源充足。

如需更详细的参数说明或示例代码，可参考项目代码库中的测试文件（如`test_api_comprehensive.py`）或相关文档。未来版本的接口文档将进一步补充请求和响应示例，以便于开发人员快速上手。

## 📋 结论

本后端接口开发文档梳理了Office-Doc-Agent项目中已实现的45个API端点，覆盖了从页面访问到复杂文档处理的全方位功能。通过对API进行模块化分类，本文档为开发人员提供了清晰的接口参考，有助于接口调用、测试验证及后续功能扩展。

在未来的开发工作中，建议团队持续更新接口文档，确保其与代码实现保持同步。同时，针对部分高频使用接口（如文档上传和填写接口），可考虑开发更详细的使用教程或SDK，以提升开发效率和用户体验。

---
**文档人**: AI Assistant (Claude)  
**文档时间**: 2025年6月26日  
**版本**: v1.0  
**状态检测**: 已完成 (2025-06-26 09:30:00)  
**审核状态**: 待审核
